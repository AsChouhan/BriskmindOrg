@isTest
private class PushSiteFeedTest {

	@testSetup static void setup() {
    	App_Config__c appConfigRecord = TestHelper.setupAppConfig();
    	People__c ppl = TestHelper.createPeopleRecordForUser(UserInfo.getUSerId());
        User userAsManager = TestHelper.createUser('Simpplr_usrAsSiteManager', null, false);
        People_Preference__c peoplePreferenceRecord = TestHelper.createPeoplePreference(ppl.Id);
        
        CollaborationGroup cgroup = TestHelper.createCollaborationGroup('SiteExternalApps_Group','Public');
        
        List<App_Integration__c>  appIntegList = TestHelper.createAppIntegrationRecords(true, new Set<String>{IntegrationConstants.INTEGRATION_TYPE_SLACK});
		People_Integration__c peopleIntegrationObj = TestHelper.createPeopleIntegRecordForUser(getPeople().Id,IntegrationConstants.INTEGRATION_TYPE_SLACK_CONTENT_SHARE,appIntegList[0].id);
    }
    
    private static People__c getPeople() {
        People__c peopleObj = [Select Id From People__c Limit 1];
        return peopleObj;
    }
    
    private static Simpplr_Site__c getSiteConfig(){
    	 return([select id, Chatter_Group_Id__c, Site_Type__c, Name, Is_Deleted__c, Slack_Access_Token__c, Slack_Channel_Id__c, Slack_Channel_Name__c, 
    	 		Slack_Comment_Enabled__c, Slack_Integration_Enabled__c, Slack_Post_Enabled__c, Slack_Url__c, 
    	 		Microsoft_Teams_Comment_Enabled__c, Microsoft_Teams_Webhook_URL__c, Microsoft_Teams_Integration_Enabled__c, Microsoft_Teams_Site_Manager__c, 
    	 		Slack_Site_Manager__r.User__c, Slack_Site_Manager__r.User__r.Name, Slack_Site_Manager__r.User__r.Username, Is_Content_Unfurl_Enabled__c,
    	 		Microsoft_Teams_Site_Manager__r.User__c, Microsoft_Teams_Site_Manager__r.User__r.Username, External_Apps_Site_Config_Json__c
    	 		from Simpplr_Site__c where name= 'SiteExternalApps_Group' limit 1]);
    }
    
   @isTest static void testPushSlackNotification() {
    	String feedItemJSON1 = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"poll":{"totalVoteCount":1,"choices":[{"id":"testId","position":1,"text":"testText","voteCount":1,"voteCountRatio":1}]},"content":{"downloadUrl":"testDownloaadUrl","fileExtension":".txt","fileSize":"22","fileType":"text","id":"contentTestId","title":"testTitle"},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":[{"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","topicUrl":"/services/data/v36.0/connect/topics?q=Google&exactMatch=true","type":"Hashtag","url":"/services/data/v36.0/chatter/feed-elements?q=%23Google"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"hey there goog [Crossed-out text: work] @Anubhav Gupta  @Site Admin  #Google- aa- bb- cc- dd"},"capabilities":{"content":{"checksum":"f721d878ca69178d3aa198a7bbb93ffb","contentUrl":null,"description":null,"downloadUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/download/0686A000002ONOn?asPdf=false&operationContext=CHATTER","fileExtension":"jpg","fileSize":"128749","fileType":"Image - jpg","hasPdfPreview":false,"id":"0696A000002JpVaQAK","isInMyFileSync":false,"mimeType":"image/jpeg","renditionUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB120BY90&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl240By180":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB240BY180&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl720By480":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","sharingOption":"Allowed","textPreview":null,"thumb120By90RenditionStatus":"Processing","thumb240By180RenditionStatus":"Processing","thumb720By480RenditionStatus":"Processing","title":"Lenovo-p780-camera-sample-10.jpg","versionId":"0686A000002ONOnQAO"},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null}},"clientInfo":null,"createdDate":"2018-06-26T08:57:27.000Z","feedElement":{"id":"0D56A00000aUXm2SAG","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG"},"id":"0D76A0000009csNSAQ","isDeleteRestricted":false,"likes":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/likes","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0},"likesMessage":null,"moderationFlags":null,"myLike":null,"parent":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"relativeCreatedDate":"Just now","type":"ContentComment","url":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ","user":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"}}],"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":{"firstName":"test","displayName":"test","lastName":"testing","name":"testName","title":"testTitle"},"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
		String feedItemJSON2 = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":null,"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
        String slackThumbURL = 'testURL';
        Simpplr_Site__c siteRecord = getSiteConfig();
		siteRecord.Slack_Post_Enabled__c = true;
		siteRecord.Slack_Comment_Enabled__c = true;
		siteRecord.Slack_Access_Token__c = 'slackAccessTokenTest';
		siteRecord.Slack_Channel_Id__c = 'slackChannelIdTest';
		siteRecord.Microsoft_Teams_Integration_Enabled__c = true;
		siteRecord.Microsoft_Teams_Comment_Enabled__c = true;
		siteRecord.Microsoft_Teams_Webhook_URL__c = 'webhookURlTest';
        siteRecord.Slack_Site_Manager__c = getPeople().id;
		update siteRecord;
		Test.startTest();
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushSlackNotification', false)); 
		PushSiteFeed.pushSlackNotification(feedItemJSON1, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
        PushSiteFeed.pushSlackNotification(feedItemJSON2, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushSlackNotificationEmail', false));
		PushSiteFeed.pushSlackNotification(feedItemJSON1, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
		Test.stopTest();
		System.assert(true,'Running as expected');
    }
    
   
    
   @isTest static void testPushMicrosoftTeamsNotification() {
    	String feedItemJSON = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"poll":{"totalVoteCount":1,"choices":[{"id":"testId","position":1,"text":"testText","voteCount":1,"voteCountRatio":1}]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":[{"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","topicUrl":"/services/data/v36.0/connect/topics?q=Google&exactMatch=true","type":"Hashtag","url":"/services/data/v36.0/chatter/feed-elements?q=%23Google"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"hey there goog [Crossed-out text: work] @Anubhav Gupta  @Site Admin  #Google- aa- bb- cc- dd"},"capabilities":{"content":{"checksum":"f721d878ca69178d3aa198a7bbb93ffb","contentUrl":null,"description":null,"downloadUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/download/0686A000002ONOn?asPdf=false&operationContext=CHATTER","fileExtension":"jpg","fileSize":"128749","fileType":"Image - jpg","hasPdfPreview":false,"id":"0696A000002JpVaQAK","isInMyFileSync":false,"mimeType":"image/jpeg","renditionUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB120BY90&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl240By180":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB240BY180&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl720By480":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","sharingOption":"Allowed","textPreview":null,"thumb120By90RenditionStatus":"Processing","thumb240By180RenditionStatus":"Processing","thumb720By480RenditionStatus":"Processing","title":"Lenovo-p780-camera-sample-10.jpg","versionId":"0686A000002ONOnQAO"},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null}},"clientInfo":null,"createdDate":"2018-06-26T08:57:27.000Z","feedElement":{"id":"0D56A00000aUXm2SAG","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG"},"id":"0D76A0000009csNSAQ","isDeleteRestricted":false,"likes":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/likes","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0},"likesMessage":null,"moderationFlags":null,"myLike":null,"parent":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"relativeCreatedDate":"Just now","type":"ContentComment","url":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ","user":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"}}],"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
		String feedItemJSON2 = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":null,"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
        Simpplr_Site__c siteRecord = getSiteConfig();
		siteRecord.Slack_Post_Enabled__c = true;
		siteRecord.Slack_Comment_Enabled__c = true;
		siteRecord.Slack_Access_Token__c = 'slackAccessTokenTest';
		siteRecord.Slack_Channel_Id__c = 'slackChannelIdTest';
		siteRecord.Microsoft_Teams_Integration_Enabled__c = true;
		siteRecord.Microsoft_Teams_Comment_Enabled__c = true;
		siteRecord.Microsoft_Teams_Webhook_URL__c = 'webhookURlTest';
       	update siteRecord; 
        Test.startTest();
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushMicrosoftTeamsNotification', false));
		PushSiteFeed.pushMicrosoftTeamsNotification(feedItemJSON, new List<Simpplr_Site__c>{getSiteConfig()});
        PushSiteFeed.pushMicrosoftTeamsNotification(feedItemJSON2, new List<Simpplr_Site__c>{getSiteConfig()});
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Error', 403, '/pushsitefeed/pushMicrosoftTeamsNotification', true));
		PushSiteFeed.pushMicrosoftTeamsNotification(feedItemJSON, new List<Simpplr_Site__c>{getSiteConfig()});
		Test.stopTest();
		System.assert(true,'Running as expected');
    }
    
    @isTest static void testQueueablePushSiteFeed() {
        Test.startTest();
        String feedItemJson = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":[{"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","topicUrl":"/services/data/v36.0/connect/topics?q=Google&exactMatch=true","type":"Hashtag","url":"/services/data/v36.0/chatter/feed-elements?q=%23Google"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"hey there goog [Crossed-out text: work] @Anubhav Gupta  @Site Admin  #Google- aa- bb- cc- dd"},"capabilities":{"content":{"checksum":"f721d878ca69178d3aa198a7bbb93ffb","contentUrl":null,"description":null,"downloadUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/download/0686A000002ONOn?asPdf=false&operationContext=CHATTER","fileExtension":"jpg","fileSize":"128749","fileType":"Image - jpg","hasPdfPreview":false,"id":"0696A000002JpVaQAK","isInMyFileSync":false,"mimeType":"image/jpeg","renditionUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB120BY90&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl240By180":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB240BY180&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl720By480":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","sharingOption":"Allowed","textPreview":null,"thumb120By90RenditionStatus":"Processing","thumb240By180RenditionStatus":"Processing","thumb720By480RenditionStatus":"Processing","title":"Lenovo-p780-camera-sample-10.jpg","versionId":"0686A000002ONOnQAO"},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null}},"clientInfo":null,"createdDate":"2018-06-26T08:57:27.000Z","feedElement":{"id":"0D56A00000aUXm2SAG","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG"},"id":"0D76A0000009csNSAQ","isDeleteRestricted":false,"likes":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/likes","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0},"likesMessage":null,"moderationFlags":null,"myLike":null,"parent":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"relativeCreatedDate":"Just now","type":"ContentComment","url":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ","user":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"}}],"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
        Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushMicrosoftTeamsNotification', false));
        PushSiteFeed.QueueablePushSiteFeed pushSiteFeedObj = new PushSiteFeed.QueueablePushSiteFeed(feedItemJson,'TestUrl', '{}');
        ID jobID = System.enqueueJob(pushSiteFeedObj);
        System.assert(true, 'Running as Expected');
        Test.stopTest();
    }
    
    @isTest static void testgetSlackChatPostJson() {
        Test.startTest();
        PushSiteFeed.getSlackChatPostJson('','','','','');
        PushSiteFeed.getSlackLink('test', 'testUrl');
        System.assert(true, 'Running as Expected');
        Test.stopTest();
    }

	@isTest static void testPushMicrosoftTeamsNotificationPhase2() {
    	String feedItemJSON = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"poll":{"totalVoteCount":1,"choices":[{"id":"testId","position":1,"text":"testText","voteCount":1,"voteCountRatio":1}]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":[{"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","topicUrl":"/services/data/v36.0/connect/topics?q=Google&exactMatch=true","type":"Hashtag","url":"/services/data/v36.0/chatter/feed-elements?q=%23Google"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"hey there goog [Crossed-out text: work] @Anubhav Gupta  @Site Admin  #Google- aa- bb- cc- dd"},"capabilities":{"content":{"checksum":"f721d878ca69178d3aa198a7bbb93ffb","contentUrl":null,"description":null,"downloadUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/download/0686A000002ONOn?asPdf=false&operationContext=CHATTER","fileExtension":"jpg","fileSize":"128749","fileType":"Image - jpg","hasPdfPreview":false,"id":"0696A000002JpVaQAK","isInMyFileSync":false,"mimeType":"image/jpeg","renditionUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB120BY90&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl240By180":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB240BY180&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl720By480":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","sharingOption":"Allowed","textPreview":null,"thumb120By90RenditionStatus":"Processing","thumb240By180RenditionStatus":"Processing","thumb720By480RenditionStatus":"Processing","title":"Lenovo-p780-camera-sample-10.jpg","versionId":"0686A000002ONOnQAO"},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null}},"clientInfo":null,"createdDate":"2018-06-26T08:57:27.000Z","feedElement":{"id":"0D56A00000aUXm2SAG","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG"},"id":"0D76A0000009csNSAQ","isDeleteRestricted":false,"likes":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/likes","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0},"likesMessage":null,"moderationFlags":null,"myLike":null,"parent":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"relativeCreatedDate":"Just now","type":"ContentComment","url":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ","user":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"}}],"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
		String feedItemJSON2 = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":null,"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
        Simpplr_Site__c siteRecord = getSiteConfig();
		siteRecord.Microsoft_Teams_Integration_Enabled__c = true;
		siteRecord.Microsoft_Teams_Comment_Enabled__c = true;
		siteRecord.External_Apps_Site_Config_Json__c = '{"msTeamsSiteConfig": {  "webUrl" : "https://teams.microsoft.com/l/channel/19%3A18774be2d0b6452cacaa9b679b3e49cc%40thread.tacv2/People%20of%20Simpplr?groupId=4841a72f-9ab7-4e9d-b65f-124cf5e51d1a&tenantId=3c0a0034-da1f-479d-a860-082149bd9a54&allowXTenantAccess=False",  "msTeamsTeamName" : "Simpplr Inc",  "msTeamsTeamId" : "4841a72f-9ab7-4e9d-b65f-124cf5e51d1a",  "msTeamsSiteFeedOptions" : [ "msTeamsPosts", "msTeamsReplies", "msTeamsTimeline" ],  "msTeamsConnectedUserId" : "f94e5a8b-a77d-4ac0-b998-9d13133582be",  "msTeamsChannelName" : "People of Simpplr",  "msTeamsChannelId" : "19:18774be2d0b6452cacaa9b679b3e49cc@thread.tacv2",  "microsoftTeamsConnectedAs" : "Frank Hobert - frank.hobert@simpplr.net"}}';
		update siteRecord; 
       	
       	Test.startTest();
       	Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushMicrosoftTeamsNotification', false));
		PushSiteFeed.pushMicrosoftTeamsNotification(feedItemJSON, new List<Simpplr_Site__c>{getSiteConfig()});
        PushSiteFeed.pushMicrosoftTeamsNotification(feedItemJSON2, new List<Simpplr_Site__c>{getSiteConfig()});
       	Test.stopTest();
		System.assert(true,'Running as expected');
    }

	@isTest static void testPushSlackNotificationPhase2() {
    	String feedItemJSON = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"poll":{"totalVoteCount":1,"choices":[{"id":"testId","position":1,"text":"testText","voteCount":1,"voteCountRatio":1}]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":[{"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","topicUrl":"/services/data/v36.0/connect/topics?q=Google&exactMatch=true","type":"Hashtag","url":"/services/data/v36.0/chatter/feed-elements?q=%23Google"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"hey there goog [Crossed-out text: work] @Anubhav Gupta  @Site Admin  #Google- aa- bb- cc- dd"},"capabilities":{"content":{"checksum":"f721d878ca69178d3aa198a7bbb93ffb","contentUrl":null,"description":null,"downloadUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/download/0686A000002ONOn?asPdf=false&operationContext=CHATTER","fileExtension":"jpg","fileSize":"128749","fileType":"Image - jpg","hasPdfPreview":false,"id":"0696A000002JpVaQAK","isInMyFileSync":false,"mimeType":"image/jpeg","renditionUrl":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB120BY90&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl240By180":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB240BY180&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","renditionUrl720By480":"https://c.na50.content.force.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0686A000002ONOn&operationContext=CHATTER&contentId=05T6A000009BEvT","sharingOption":"Allowed","textPreview":null,"thumb120By90RenditionStatus":"Processing","thumb240By180RenditionStatus":"Processing","thumb720By480RenditionStatus":"Processing","title":"Lenovo-p780-camera-sample-10.jpg","versionId":"0686A000002ONOnQAO"},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null}},"clientInfo":null,"createdDate":"2018-06-26T08:57:27.000Z","feedElement":{"id":"0D56A00000aUXm2SAG","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG"},"id":"0D76A0000009csNSAQ","isDeleteRestricted":false,"likes":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ/likes","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0},"likesMessage":null,"moderationFlags":null,"myLike":null,"parent":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"relativeCreatedDate":"Just now","type":"ContentComment","url":"/services/data/v36.0/chatter/comments/0D76A0000009csNSAQ","user":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"}}],"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
		String feedItemJSON2 = '{"actor":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"body":{"isRichText":true,"messageSegments":[{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupBegin"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupBegin"},{"text":"hey","type":"Text"},{"htmlTag":"u","markupType":"Underline","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupBegin"},{"text":"there","type":"Text"},{"htmlTag":"b","markupType":"Bold","text":"","type":"MarkupEnd"},{"text":" ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupBegin"},{"text":"goog ","type":"Text"},{"htmlTag":"i","markupType":"Italic","text":"","type":"MarkupEnd"},{"htmlTag":"s","markupType":"Strikethrough","text":"[Crossed-out text: ","type":"MarkupBegin"},{"text":"work","type":"Text"},{"htmlTag":"s","markupType":"Strikethrough","text":"]","type":"MarkupEnd"},{"text":" ","type":"Text"},{"accessible":true,"name":"Anubhav Gupta","record":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","name":"Anubhav Gupta","reputation":null,"title":null,"type":"User"},"text":"@Anubhav Gupta","type":"Mention"},{"text":"  ","type":"Text"},{"accessible":true,"name":"Site Admin","record":{"community":null,"description":null,"emailToChatterAddress":null,"id":"0F96A000000UH93SAG","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"memberCount":4,"myRole":"GroupOwner","name":"Site Admin","type":"CollaborationGroup","visibility":"PublicAccess"},"text":"@Site Admin","type":"Mention"},{"text":"  ","type":"Text"},{"tag":"Google","text":"#Google","type":"Hashtag"},{"htmlTag":"p","markupType":"Paragraph","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"aa","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"bb","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ul","markupType":"UnorderedList","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupBegin"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"cc","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"li","markupType":"ListItem","text":"- ","type":"MarkupBegin"},{"text":"dd","type":"Text"},{"htmlTag":"li","markupType":"ListItem","text":"","type":"MarkupEnd"},{"htmlTag":"ol","markupType":"OrderedList","text":"","type":"MarkupEnd"}],"text":"aaa"},"canShare":true,"capabilities":{"associatedActions":{"platformActionGroups":[]},"bookmarks":{"isBookmarkedByCurrentUser":false},"chatterLikes":{"isLikedByCurrentUser":false,"likesMessage":null,"myLike":null,"page":{"currentPageToken":0,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/chatter-likes/items","items":[],"nextPageToken":null,"nextPageUrl":null,"previousPageToken":null,"previousPageUrl":null,"total":0}},"comments":{"page":{"currentPageToken":null,"currentPageUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/comments/items","items":null,"nextPageToken":null,"nextPageUrl":null,"total":1}},"edit":{"isEditRestricted":false,"isEditableByMeUrl":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG/capabilities/edit/is-editable-by-me","lastEditedBy":null,"lastEditedDate":null,"latestRevision":1,"relativeLastEditedDate":null},"mute":{"isMutedByMe":false},"topics":{"canAssignTopics":true,"items":[{"createdDate":"2017-05-10T10:47:42.000Z","description":null,"id":"0TO6A000000Kz8LWAS","images":{"coverImageUrl":null,"featuredImageUrl":null},"isBeingDeleted":false,"name":"Google","nonLocalizedName":"Google","talkingAbout":1,"url":"/services/data/v36.0/connect/topics/0TO6A000000Kz8LWAS"}]}},"clientInfo":null,"createdDate":"2018-06-26T08:55:49.000Z","event":false,"feedElementType":"FeedItem","header":{"isRichText":null,"messageSegments":[{"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"reference":{"id":"0F96A000000UH93SAG","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG"},"text":"Site Admin","type":"EntityLink"},{"text":" — ","type":"Text"},{"motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"reference":{"id":"0056A000000YmVKQA0","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0"},"text":"Anubhav Gupta","type":"EntityLink"}],"text":"Site Admin — Anubhav Gupta"},"id":"0D56A00000aUXm2SAG","isDeleteRestricted":false,"modifiedDate":"2018-06-26T08:57:27.000Z","originalFeedItem":null,"originalFeedItemActor":null,"parent":{"announcement":null,"canHaveChatterGuests":false,"community":null,"description":null,"emailToChatterAddress":null,"id":"' + getSiteConfig().Chatter_Group_Id__c + '","isArchived":false,"isAutoArchiveDisabled":true,"isBroadcast":false,"lastFeedElementPostDate":"2018-06-26T08:55:49.000Z","memberCount":4,"motif":{"color":"83B6FF","largeIconUrl":"/img/icon/groups64.png","mediumIconUrl":"/img/icon/groups32.png","smallIconUrl":"/img/icon/groups16.png"},"myRole":"GroupOwner","mySubscription":{"id":"0FB6A000000GuGMWA0","url":"/services/data/v36.0/chatter/group-memberships/0FB6A000000GuGMWA0"},"name":"Site Admin","owner":{"communityNickname":"anubhav","companyName":"Wildcraft","displayName":"Anubhav Gupta","firstName":"Anubhav","id":"0056A000000YmVKQA0","isActive":true,"isInThisCommunity":true,"lastName":"Gupta","motif":{"color":"65CAE4","largeIconUrl":"/img/icon/profile64.png","mediumIconUrl":"/img/icon/profile32.png","smallIconUrl":"/img/icon/profile16.png"},"name":"Anubhav Gupta","reputation":null,"title":null,"type":"User","url":"/services/data/v36.0/chatter/users/0056A000000YmVKQA0","userType":"Internal"},"type":"CollaborationGroup","url":"/services/data/v36.0/chatter/groups/0F96A000000UH93SAG","visibility":"PublicAccess"},"photoUrl":"https://c.na50.content.force.com/profilephoto/7296A000000XfG9/T","relativeCreatedDate":"1m ago","type":"TextPost","url":"/services/data/v36.0/chatter/feed-elements/0D56A00000aUXm2SAG","visibility":"AllUsers"}';
		String slackThumbURL = 'testURL';
        Simpplr_Site__c siteRecord = getSiteConfig();
		siteRecord.Slack_Integration_Enabled__c = true;
		siteRecord.External_Apps_Site_Config_Json__c = '{  "slackSiteConfig" : {    "slackWebUrl" : "https://slack.com/archives/C03U55K5UFQ",    "slackSiteFeedOptions" : [ "slackPosts", "slackPostAndReplies", "slackTimeline" ],    "slackConnectedAs" : "tanviladkani2",    "slackChannelName" : "general",    "slackChannelId" : "C03U55K5UFQ"  ,"slackConnectedUserId" : "U0472JS283W"}}';
		update siteRecord; 
       	
		Test.startTest();
		SimpplrContext.isSlackPhase2FeatureEnabled = true;
		SimpplrContext.isSlackUpgraded = true;
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushSlackNotification', false)); 
		PushSiteFeed.pushSlackNotification(feedItemJSON, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
        PushSiteFeed.pushSlackNotification(feedItemJSON2, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
		Test.setMock(HttpCalloutMock.class, new TestMockHttpResponseGenerator('Ok', 200, '/pushsitefeed/pushSlackNotificationEmail', false));
		PushSiteFeed.pushSlackNotification(feedItemJSON, slackThumbURL, new List<Simpplr_Site__c>{getSiteConfig()}, '{}');
		Test.stopTest();
		System.assert(true,'Running as expected');
    }


}