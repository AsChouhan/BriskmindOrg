(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{2582:function(e,t,n){e.exports={definitionList:"DefinitionList-module-definitionList___3BZ_6",title:"DefinitionList-module-title___2Pqwr",content:"DefinitionList-module-content___3au59",seperator:"DefinitionList-module-seperator___5WWW5","seperator--dashed":"DefinitionList-module-seperator--dashed___23ZZb",split:"DefinitionList-module-split___3wNvj",squashed:"DefinitionList-module-squashed___1ksg3",stacked:"DefinitionList-module-stacked___3amYU",lined:"DefinitionList-module-lined____K3g9",item:"DefinitionList-module-item___2-bQd",stackedBorder:"DefinitionList-module-stackedBorder___2w8TJ"}},2583:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(10),i=n.n(a),r=n(11),c=n.n(r),s=n(12),l=n.n(s),o=n(13),u=n.n(o),m=n(8),d=n.n(m),p=n(5),b=n.n(p),f=n(15),g=n.n(f),O=n(1),v=n.n(O),y=n(0),j=n.n(y),E=n(1004),h=n(2582),_=n.n(h);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=d()(e);if(t){var i=d()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return u()(this,n)}}var S=function(e){l()(n,e);var t=I(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e,t=this.props,n=t.title,a=t.children,i=t.isBlock,r=t.isHtml,c=t.whiteSpaceNormal,s=g()((e={},b()(e,_.a.item,!0),b()(e,"u-whiteSpaceNormal",c),e));if(!a)return null;var l=r&&"string"==typeof a?j.a.createElement("dd",{className:_.a.content,dangerouslySetInnerHTML:{__html:Object(E.a)(a)}}):j.a.createElement("dd",{className:_.a.content},a),o=j.a.createElement(j.a.Fragment,null,j.a.createElement("dt",{className:_.a.title},n),l);return i?j.a.createElement("div",{className:s},o):o}}]),n}(j.a.PureComponent);b()(S,"propTypes",{title:v.a.node.isRequired,children:v.a.node,isBlock:v.a.bool,isHtml:v.a.bool,whiteSpaceNormal:v.a.bool}),b()(S,"defaultProps",{whiteSpaceNormal:v.a.bool})},2593:function(e,t,n){"use strict";var a=n(5),i=n.n(a),r=n(15),c=n.n(r),s=n(1),l=n.n(s),o=n(0),u=n.n(o),m=n(2582),d=n.n(m);function p(e){var t,n=e.children,a=e.layout,r=u.a.Children.toArray(n).filter((function(e){return!!e}));if(0===r.length)return!1;var s=c()((t={},i()(t,d.a.definitionList,!0),i()(t,d.a[a],a),t));return u.a.createElement("dl",{className:s},r)}p.propTypes={children:l.a.node.isRequired,layout:l.a.oneOf(["stacked","squashed","lined","stackedBorder"])},p.defaultProps={layout:null},t.a=p},2648:function(e,t,n){"use strict";(function(e){var a=n(16),i=n.n(a),r=n(71),c=n.n(r),s=n(0),l=n.n(s),o=n(53),u=n(2649),m=n(324),d=n(654),p=n(284),b=n(3),f=n(1012),g=n(380);function O(t){var n=t.input,a=t.meta,r=t.isDisabled,s=c()(t,["input","meta","isDisabled"]),O=Object(d.a)(e.Simpplr.Salesforce.Audience.search,{size:9999}),v=O.loading,y=O.loaded,j=O.result,E=Object(m.b)(),h=E.isSegmentManager,_=E.isAppManager,I=h||_,S=y&&!j.listOfItems.length;return l.a.createElement(g.a,i()({input:n,meta:a},s),l.a.createElement(f.a,i()({isLoading:v,options:y&&j.listOfItems.map(p.c)||[],makeOption:function(e){var t=e.audienceId,n=e.name,a=e.audienceCount;return{value:t,label:"".concat(n," (").concat(a,")")}},renderOption:function(e){var t=e.data.item;return l.a.createElement(u.a,{audience:t})}},s,{isDisabled:r||S,value:n.value,onChange:n.onChange,onFocus:n.onFocus,onBlur:function(){return n.onBlur(n.value)}})),S&&l.a.createElement("div",{className:"Field-error"},l.a.createElement("span",null,I?Object(b.a)("audiences.no_list_info",{link:l.a.createElement(o.a,{className:"type--error type--fauxLink--alt",to:"/audiences"})}):Object(b.a)("audiences.no_audience_standard_user_info"))))}O.propTypes={},t.a=O}).call(this,n(27))},2649:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(18),c=n(299),s=n(66),l=n(209),o=n(56),u=n(17),m=n(32),d=n(3);function p(e){var t=e.audience,n=Object(l.h)("peopleCustomFieldSingular"),a=Object(r.useSelector)(u.e),o=t.get("segment")&&"Segment:".concat(t.get("segment").name),p=t.get("listOfConditions")&&t.get("listOfConditions").map((function(e){var t=e.name,i=e.values,r="hireDate"===t&&i[0]?Object(d.a)("hireDateAfter"===i[0].id?"common.date_on_or_after":"common.date_on_or_before",{date:Object(m.e)(i[0].name,s.b)}):i.map((function(e){return e.name})).join(", "),c="category"===t&&n;if(!c){var l=a(t);c=l&&l.singular}return c||(c="hireDate"===t?Object(d.a)("profile_fields.hire_date"):Object(d.a)("profile_fields.".concat(t))),"".concat(c,":").concat(r)})).join(", "),b=t.get("listOfPeople")&&t.get("listOfPeople").map((function(e){return e.name})).join(", "),f=p||b,g=o?"".concat(o,", ").concat(f):f;return i.a.createElement(c.a,null,i.a.createElement("div",{className:"Panel-item"},i.a.createElement("span",{className:"type--500 type--b2"},"".concat(t.get("name")," (").concat(t.get("audienceCount"),")")),i.a.createElement("span",{className:"u-displayBlock type--b4 u-textTruncate"},g)))}p.propTypes={audience:o.a.audience.isRequired},t.a=p},2650:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(18),c=n(2583),s=n(66),l=n(209),o=n(17),u=n(32),m=n(3);t.a=function(e){var t=e.name,n=e.values,a=Object(l.h)("peopleCustomFieldSingular"),d=Object(r.useSelector)(o.e),p="hireDate"===t&&n[0]?Object(m.a)("hireDateAfter"===n[0].id?"common.date_on_or_after":"common.date_on_or_before",{date:Object(u.e)(n[0].name,s.b)}):n.map((function(e){return e.name})).join(", "),b="category"===t&&a;if(!b){var f=d(t);b=f&&f.singular}return b||(b="hireDate"===t?Object(m.a)("profile_fields.hire_date"):Object(m.a)("profile_fields.".concat(t))),i.a.createElement("div",{key:b,className:"u-whiteSpaceNormal"},i.a.createElement(c.a,{title:"".concat(b,":"),whiteSpaceNormal:!0},p))}},2664:function(e,t,n){"use strict";var a=n(4),i=n.n(a),r=n(1),c=n.n(r),s=n(0),l=n.n(s),o=n(479),u=n(198),m=n(215),d=n(1008),p=n(1014),b=n(67),f=n(52),g=n(113),O=n(1009),v=n(73),y=n(3);function j(e){var t=e.segmentId,n=e.subscriptionId,a=e.audienceId,r=e.expertiseId,c=Object(O.a)({initialParams:new i.a.Map({sortBy:"alphabetical",segmentId:t,subscriptionId:n,audienceId:a,expertiseId:r})}),f=c.users,g=c.loading,j=c.canPaginate,E=c.loadMore,h=c.params,_=c.setParams,I=c.csvUrl,S=Object(s.useCallback)((function(e){_({term:e.get("term")})}),[_]),w=g&&0===f.size&&l.a.createElement(m.a,{hasBorder:!0});return l.a.createElement("div",{className:"u-pad-b--medium"},l.a.createElement("div",{className:"row u-marg-b--xlarge"},l.a.createElement("div",{className:"large-4 column"},l.a.createElement("div",{className:"u-marg-t--medium"},l.a.createElement(o.a,{placeholder:Object(y.a)("field.people_search.label"),initialValue:h.get("term"),onSubmit:S,ariaLabel:Object(y.a)("field.people_search.label")}))),l.a.createElement("div",{className:"large-8 column"},l.a.createElement("div",{className:"u-marg--medium"},l.a.createElement("span",{className:"toolbar-download"},g?l.a.createElement(m.a,{small:!0}):l.a.createElement(u.a,{onClick:function(){Object(v.b)(b.m,"")},url:I}))))),l.a.createElement("div",{className:""},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"column"},w||l.a.createElement(d.a,{itemComponent:p.a,users:f,isLoading:g,canPaginate:j,onLoadMore:E,showFollow:!1,showPopovers:!1})))))}j.propTypes={segmentId:c.a.string,subscriptionId:c.a.string,audienceId:c.a.string,expertiseId:c.a.string,expertiseTitle:c.a.string},t.a=Object(g.a)((function(e){var t=e.subscriptionId,n=e.audienceId,a=e.segmentId,i=e.expertiseId,r=e.expertiseTitle,c=t&&Object(y.a)("subscriptions.user_list.modal.heading"),s=n&&Object(y.a)("audiences.user_list.heading");return{name:t?f.Zb:f.Mb,id:t||n||a||i,title:c||s||r||Object(y.a)("manage_app.segments.user_list.modal.heading"),classes:["Modal--mini"]}}))(j)},2665:function(e,t,n){"use strict";var a=n(1),i=n.n(a),r=n(0),c=n.n(r),s=n(18),l=n(53),o=n(2650),u=n(2593),m=n(2583),d=n(56),p=n(17),b=n(42),f=n(3),g=n(89);function O(e){var t=e.segment,n=e.audience,a=e.showAudienceCount,i=e.showMandatory,s=e.isSegmentsEnabled,d=e.showSegment&&s;return"everyone"===e.recipient?c.a.createElement("strong",null,Object(f.a)("common.everyone_in_org")):c.a.createElement(u.a,{layout:"squashed"},i&&c.a.createElement("div",{className:"u-marg-b--small"},c.a.createElement(m.a,{title:Object(f.a)("common.subscription")},Object(f.a)("field.mandatory.label"))),d&&c.a.createElement("div",null,c.a.createElement(m.a,{title:"".concat(Object(f.a)("common.segment"),":")},t?t.name:Object(f.a)("all_segments.label"))),n&&n.isDeleted?c.a.createElement("div",{className:"type--note type--b2 type--500"},Object(f.a)("common.deleted_audience")):n&&"conditions"===n.type&&n.listOfConditions.map((function(e){var t=e.name,n=e.values;return c.a.createElement(o.a,{key:t,name:t,values:n})}))||n&&"people"===n.type&&c.a.createElement(m.a,{title:"".concat(Object(f.a)("common.person_plural"),":"),isBlock:!0},n.listOfPeople.map((function(e,t){var n=e.peopleId,a=e.name;return c.a.createElement(r.Fragment,{key:n},t>0&&", ",c.a.createElement(l.a,{to:Object(g.l)(n),className:"u-textInheritColor"},a))}))),a&&c.a.createElement("div",{className:"u-marg-t--small"},c.a.createElement(m.a,{title:Object(f.a)("common.user_plural")},Object(b.c)(n.get("audienceCount")))))}O.propTypes={segment:d.a.segmentLite,audience:d.a.audience.isRequired,showAudienceCount:i.a.bool,showMandatory:i.a.bool,showSegment:i.a.bool,isSegmentsEnabled:i.a.bool},O.defaultProps={showAudienceCount:!1,showMandatory:!1,isSegmentsEnabled:!1,showSegment:!0},t.a=Object(s.connect)((function(e){return{customFieldLabel:Object(p.v)(e,"peopleCustomFieldSingular"),isSegmentsEnabled:Object(p.V)(e)}}))(O)},2807:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(4),i=n.n(a),r=n(14),c=n(365),s=n(757),l=n(26),o=n(3);function u(e){return Array.isArray(e)||i.a.Iterable.isIterable(e)?{type:c.n,payload:{subscriptions:e}}:(t=e,{type:c.m,payload:{subscription:t}});var t}function m(t,n){return function(a){var i={subscriptionId:t,data:n};a({type:c.k,payload:i}),e.Simpplr.Loader.show();var u=Object(s.c)(n).toJS();return e.Simpplr.Salesforce.Subscription.save(t,u).done((function(e){return a({type:c.l,payload:{subscriptionId:t,subscription:e.result}}),a(Object(r.j)(Object(o.a)("subscription.".concat(t?"save":"create",".success_flash")))),e.result.subscriptionId})).fail((function(e){var t=Object(l.a)(e);a(Object(r.f)(t)),a({type:c.j,error:i})})).always(e.Simpplr.Loader.hide)}}function d(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a){var i={subscriptionId:t,unfollowAudience:n};return a({type:c.b,payload:i}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Subscription.delete(t,n).done((function(){a({type:c.c,payload:i});var e=n?Object(o.a)("subscription.delete_unfollow.success_flash"):Object(o.a)("subscription.delete.success_flash");a(Object(r.j)(e))})).fail((function(e){var t=Object(l.a)(e);a(Object(r.f)(t)),a({type:c.a,error:i})})).always(e.Simpplr.Loader.hide)}}function p(t){return function(n){var a={subscriptionId:t};return n({type:c.h,payload:a}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Subscription.rerun(t).done((function(){n({type:c.i,payload:a}),n(Object(r.j)(Object(o.a)("subscription.re_run.success_flash")))})).fail((function(e){var t=Object(l.a)(e);n(Object(r.f)(t)),n({type:c.g,error:a})})).always(e.Simpplr.Loader.hide)}}}).call(this,n(27))},2939:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return o}));var a=n(4),i=n.n(a),r=n(19);function c(e){return e.get("subscriptions")}Object(r.a)([c,function(e,t){return t}],(function(e,t){return e.getIn([t,"result"])}));var s=Object(r.a)([c],(function(e){return e.map((function(e){return e.get("result")})).filter((function(e){return!!e}))})),l=Object(r.a)([s,function(e,t){return new i.a.List(t)}],(function(e,t){return t.map((function(t){return e.get(t)})).filter((function(e){return!!e}))}));function o(e,t){return e.filter((function(e){return"listOfSites"===e.action.itemKey})).groupBy((function(e){return e.action.listOfItems.find((function(e){return e.getIn(["item","id"])===t})).get("status")}))}},3044:function(e,t,n){"use strict";var a=n(4),i=n.n(a),r=n(1),c=n.n(r),s=n(0),l=n.n(s),o=n(69),u=n.n(o),m=n(18),d=n(1011),p=n(2807),b=n(165),f=n(241),g=n(2665),O=n(10),v=n.n(O),y=n(11),j=n.n(y),E=n(12),h=n.n(E),_=n(13),I=n.n(_),S=n(8),w=n.n(S),N=n(81),C=n(192),L=n(128),x=n(217),M=n(3),P=n(411);function k(e){var t,n=e.status,a=n;return"rejected"===n?t="negative":"pending"===n&&(t="warning"),t?l.a.createElement(P.a,{text:Object(M.a)("status.".concat(a)),status:t}):null}k.propTypes={status:c.a.string},k.defaultProps={};var A=k;function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=w()(e);if(t){var i=w()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return I()(this,n)}}var T=function(e){h()(n,e);var t=D(n);function n(){return v()(this,n),t.apply(this,arguments)}return j()(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.currentItemId,a=e.type,i=e.isUnlistedAdmin,r=0,c=t.filter((function(e){var t="listOfPeople"===a||i||e.getIn(["item","isListed"])||e.getIn(["item","isMember"]);return t||(r+=1),t}));return l.a.createElement(C.a,{isStacked:!0},c.sortBy((function(e){var t=e.getIn(["item","name"]);return n?"".concat(e.getIn(["item","id"])!==n,"-").concat(t):t})).map((function(e){var t=e.getIn(["item","id"]),i=e.getIn(["item","name"]),r=t===n,c=!e.getIn(["item","isActive"])||e.getIn(["item","isChatterGroupOnly"]),s=l.a.createElement("a",{href:e.getIn(["item","url"]),className:"u-textInheritColor"},i);return c?s=l.a.createElement(x.a,{title:Object(M.a)("".concat("listOfPeople"===a?"user":"site",".inactive_tooltip")),isInline:!0},l.a.createElement("span",{className:"type--secondary u-lineThrough"},s)):n&&!r?s=l.a.createElement("span",{className:"type--secondary"},s):"public"!==e.getIn(["item","access"])&&"approved"===e.get("status")&&e.get("actionedBy")&&(s=l.a.createElement(x.a,{title:Object(M.a)("subscription.approved_by",{name:e.getIn(["actionedBy","name"])}),isInline:!0},s)),l.a.createElement(L.a,{key:t},l.a.createElement("div",{className:"u-marg-b--xsmall"},s,l.a.createElement("span",{className:"u-hideIfEmpty u-marg-l--xsmall"},l.a.createElement(A,{status:e.get("status")}))))})),r>0&&l.a.createElement(L.a,null,l.a.createElement("div",{className:"u-marg-b--xsmall"},Object(M.a)("subscription.".concat(c.size<=0?"only_":"","unlisted_site_count"),{count:r}))))}}]),n}(N.b);T.propTypes={items:u.a.list,currentItemId:c.a.string,type:c.a.oneOf(["listOfSites","listOfPeople"]).isRequired,isUnlistedAdmin:c.a.bool},T.defaultProps={items:new i.a.List,isUnlistedAdmin:!1};var R=T,F=n(82),U=n(55),B=n(381),q=n(972),K=n(301),V=n(56);function z(e){var t=e.approve,n=e.reject,a=e.subscriptions;return l.a.createElement("div",{className:"Box Box--gray u-marg-b--xlarge u-pad-t--medium u-pad-l--medium u-pad-r--medium u-borderRadius--4"},l.a.createElement("h2",{className:"type--h4 u-marg-b--medium"},Object(M.a)("subscription.pending")),l.a.createElement(q.a,{data:a,hasNoLastBorder:!0,isFontInherit:!0},l.a.createElement(B.a,{label:Object(M.a)("audience"),width:"35%",whiteSpaceNormal:!0},(function(e){return l.a.createElement(l.a.Fragment,null,"audience"===e.recipient&&e.audience&&l.a.createElement("div",{className:"type--fs15 type--500 u-marg-b--xsmall"},e.audience.name),l.a.createElement(g.a,{segment:e.segment||e.audience&&e.audience.segment,audience:e.audience,recipient:e.recipient}))})),l.a.createElement(B.a,{name:"audience.audienceCount",label:Object(M.a)("common.user_plural"),textAlign:"right",width:"80px",hasExtraPadding:!0}),l.a.createElement(B.a,{label:Object(M.a)("listing.heading.created_by"),width:"28%",hasExtraPadding:!0,whiteSpaceNormal:!0},(function(e){var t=e.modifiedBy||e.createdBy;return l.a.createElement("a",{href:t.get("url"),className:"u-textInheritColor"},t.get("name"))})),l.a.createElement(B.a,{label:Object(M.a)("listing.heading.actions"),textAlign:"right"},(function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"u-marg-r--small"},l.a.createElement(b.a,{modal:l.a.createElement(K.a,{title:Object(M.a)("subscription.reject_modal.title"),buttonText:Object(M.a)("button_label.reject"),onConfirm:function(){return n(e.subscriptionId)},classes:["Modal--small"]},l.a.createElement("p",null,Object(M.a)("subscription.reject_modal.intro")),l.a.createElement(g.a,{segment:e.segment||e.audience&&e.audience.segment,audience:e.audience,recipient:e.recipient}),l.a.createElement("p",null,Object(M.a)("common.cannot_be_undone")))},(function(e){return l.a.createElement(U.a,{label:Object(M.a)("button_label.reject"),onClick:e,appearance:"danger",size:"small"})}))),l.a.createElement(b.a,{modal:l.a.createElement(K.a,{title:"mandatory"===e.action.actionType?Object(M.a)("subscription.approve_modal.title_mandatory"):Object(M.a)("subscription.approve_modal.title"),buttonText:Object(M.a)("button_label.approve"),onConfirm:function(){return t(e.subscriptionId)},classes:["Modal--small"]},l.a.createElement("div",{className:"type--primary"},l.a.createElement("p",null,Object(M.a)("subscription.approve_modal.intro")),l.a.createElement(g.a,{segment:e.segment||e.audience&&e.audience.segment,audience:e.audience,recipient:e.recipient,showMandatory:"mandatory"===e.action.actionType,showAudienceCount:!0}),l.a.createElement("div",{className:"u-border-top u-pad-t--small"},l.a.createElement("p",null,Object(M.a)("subscription.approve_modal.result_in")),l.a.createElement("ul",null,l.a.createElement("li",null,Object(M.a)("subscription.approve_modal.consequence1")),l.a.createElement("li",null,Object(M.a)("subscription.approve_modal.consequence2")),"mandatory"===e.action.actionType&&l.a.createElement("li",null,Object(M.a)("subscription.approve_modal.consequence3"))),l.a.createElement("p",{className:"type--500"},Object(M.a)("subscription.approve_modal.warning")))))},(function(e){return l.a.createElement(U.a,{label:Object(M.a)("button_label.approve"),onClick:e,icon:!1,appearance:"confirm",size:"small"})})))}))))}z.propTypes={siteId:c.a.string.isRequired,subscriptions:u.a.listOf(V.a.subscription).isRequired,approve:c.a.func.isRequired,reject:c.a.func.isRequired},z.defaultProps={};var W=Object(m.connect)(null,(function(e,t){return{approve:function(n){return e(Object(F.approveSubscription)(t.siteId,n))},reject:function(n){return e(Object(F.rejectSubscription)(t.siteId,n))}}}))(z),H=n(21),J=n(215),Z=n(20),G=n.n(Z),Q=n(34),Y=n.n(Q),X=n(7),$=n.n(X),ee=n(5),te=n.n(ee),ne=n(15),ae=n.n(ne);function ie(e,t){return e.action.get("listOfItems").find((function(e){return e.getIn(["item","id"])===t}))}function re(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,c=!!n||"listOfSites"===e.getIn(["subscription","action","itemKey"]),s=c&&e.get("isMandatory"),l=e.get("recipient"),o=e.getIn(["subscription","action"]).set("actionType",s?"mandatory":"autofollow");if(n&&(o=o.merge({itemKey:"listOfSites",listOfSites:new i.a.List([n])})),"listOfSites"===(o=o.set("listOfItems",o.get(o.get("itemKey")).map((function(e){var n=ie(t,e.get("id"))||new i.a.Map,a=new i.a.Map({subscriptionEntityId:n.get("subscriptionEntityId")||null,item:e});return"listOfSites"===o.get("itemKey")&&(a=a.set("status",n.get("status"))||null),a}))).remove("listOfSites").remove("listOfPeople")).get("itemKey")&&"listOfSites"===t.action.itemKey){var u=t.action.listOfItems.filterNot((function(e){return e.getIn(["item","isListed"])||e.getIn(["item","isMember"])}));o=o.update("listOfItems",(function(e){return e.concat(u)}))}var m=e.getIn(["subscription","membershipType"]);n||"listOfPeople"!==o.get("itemKey")||(m=void 0);var d=e.getIn(["subscription","audience"]);return t.merge({action:o,audience:d,recipient:l,membershipType:m,segment:"org"!==r.segmentId&&a?r:null})}var ce=n(37),se=n(1001),le=n(2648),oe=n(225),ue=n(1016),me=n(242),de=n(656),pe=n(483),be=n(204),fe=n(757),ge=n(30),Oe=n(120),ve=n(17),ye=n(47);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=w()(e);if(t){var i=w()(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return I()(this,n)}}var Ee="ADD_SUBSCRIPTION",he=Object(ce.formValueSelector)(Ee),_e=Object(ye.c)(Object(ye.C)(25),Object(M.a)("subscription.site_max_reached_error",{max:25})),Ie=Object(ye.c)(Object(ye.C)(25),Object(M.a)("subscription.user_max_reached_error",{max:25})),Se=function(e){h()(n,e);var t=je(n);function n(){var e;v()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),te()($()(e),"onSubmit",function(){var t=Y()(G.a.mark((function t(n){var a,i,r,c,s,l,o,u,m;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,i=a.subscription,r=a.close,c=a.site,s=a.isSegmentsEnabled,l=a.onSubmit,o=a.currentSegment,u=re(n,i,c,s,o),t.next=4,e.props.save(i.subscriptionId||null,u);case 4:m=t.sent,l(m.result.subscriptionId),e.props.warnOnClose(!1),r();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),te()($()(e),"getAudienceValues",(function(){var t=e.props,n=t.subscription,a=t.audienceValues;return n&&a?a.map((function(e,t){var a=n.audience.listOfConditions.find((function(e){return e.name===t}));if(!a)return e;var i=a.values.map((function(e){return e.set("id",e.get("id")||e.get("name"))})).filter((function(t){return!e.get("values").find((function(e){return e.get("id")===t.get("id")}))}));return i.size>0?e.set("values",e.get("values").concat(i)):e})):a||new i.a.Map})),e}return j()(n,[{key:"componentDidUpdate",value:function(){this.props.warnOnClose(this.props.dirty&&!this.props.submitting)}},{key:"render",value:function(){var e=this.props,t=(e.close,e.valid),n=e.submitting,a=e.isAnimating,i=e.handleSubmit,r=e.subscription,c=e.itemKey,s=e.site,o=e.isAudienceUpdateWarningVisible,u=e.unlistedSiteCount,m=e.isSegmentsEnabled,d=(e.canChangeSegment,e.segmentId,e.change,e.recipient),p=e.isAppManager,b=e.currentSegmentName,f=ae()({Form:!0,"is-disabled":n}),g="public"===(null==s?void 0:s.get("access")),O=l.a.createElement(ce.Field,{component:oe.a,name:"isMandatory",label:Object(M.a)("field.mandatory.label"),note:Object(M.a)("field.mandatory.note")}),v=Object(M.a)("subscription.modal.add_subscription"),y=[{label:Object(M.a)("subscription.recipients.audience"),value:"audience",icon:"audience"}];m&&p&&y.unshift({label:Object(M.a)("subscription.recipients.all_org"),value:"everyone",icon:"org",note:Object(M.a)("common.recommended")}),m&&y.unshift({label:Object(M.a)("subscription.recipients.everyone_in_segment",{segmentName:b}),value:"segment"}),m||y.unshift({label:Object(M.a)("subscription.recipients.all_org"),value:"everyone",icon:"org"});var j=l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small"},r.subscriptionId?"listOfPeople"===c&&Object(M.a)("subscription.modal.select_people"):Object(M.a)("subscription.modal.select_sites_or_people"));return r.subscriptionId&&"listOfSites"===c&&(j=""),l.a.createElement("form",{className:f,onSubmit:i(this.onSubmit)},l.a.createElement("div",{className:"Modal-content Modal-content--forms"},l.a.createElement("div",{className:"Content Content--small type--secondary"},l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement("p",null,Object(M.a)("subscription.add.description"))),l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small type--primary"},v),l.a.createElement("div",{className:"u-marg-b--small"},l.a.createElement(ce.Field,{component:me.a,name:"recipient",options:y,isStacked:!0,isLight:!0})),"audience"===d&&l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(ce.Field,{name:"subscription.audience",component:le.a,isValueModel:!0,hasLabelAbove:!0,placeholder:Object(M.a)("common.select_placeholder_audience"),validate:[ye.E],isRequired:!0})))),s&&g&&l.a.createElement("div",{className:"Modal-content Modal-content--forms"},l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small type--primary"},Object(M.a)("subscription.modal.select_membership_type")),l.a.createElement("div",{className:"u-marg-b--small"},l.a.createElement(ce.Field,{component:me.a,name:"subscription.membershipType",options:[{label:Object(M.a)("common.site_members"),value:"siteMembers",note:Object(M.a)("subscription.modal_site_member_note")},{label:Object(M.a)("common.site_followers"),value:"siteFollowers",note:Object(M.a)("subscription.modal_site_follower_note")}],isStacked:!0,isLight:!0}))),!s&&l.a.createElement("div",{className:"Modal-content Modal-content--forms"},j,!r.subscriptionId&&l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(ce.Field,{component:de.a,name:"subscription.action.itemKey",validate:[ye.E],isFullWidth:!0,hasLargeIcons:!0,options:[{label:Object(M.a)("common.site_plural"),value:"listOfSites",icon:"sites"},{label:Object(M.a)("common.person_plural"),value:"listOfPeople",icon:"audience"}]})),c&&("listOfSites"===c?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small"},Object(M.a)("subscription.modal.select_membership_type")),l.a.createElement("div",{className:"u-marg-b--small","data-testid":"radio"},l.a.createElement(ce.Field,{component:me.a,name:"subscription.membershipType",options:[{label:Object(M.a)("common.site_members"),value:"siteMembers",note:Object(M.a)("subscription.modal_site_member_note")},{label:Object(M.a)("common.site_followers"),value:"siteFollowers",note:Object(M.a)("subscription.modal_site_follower_note")}],isStacked:!0,isLight:!0})),l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small"},Object(M.a)("common.site_plural")),l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(ce.Field,{component:pe.a,name:"subscription.action.listOfSites",placeholder:Object(M.a)("field.site_selector.placeholder"),validate:[ye.E,_e,ye.t],isRequired:!0,isValueModel:!0,isMulti:!0}),u>0&&l.a.createElement("div",{className:"u-marg-t--small"},"&"," ",Object(M.a)("subscription.only_unlisted_site_count",{count:u})))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(ce.Field,{component:ue.a,name:"subscription.action.listOfPeople",placeholder:Object(M.a)("field.people_selector.placeholder"),validate:[ye.E,Ie],isRequired:!0,isValueModel:!0,isMulti:!0})),!r.subscriptionId&&l.a.createElement("div",{className:"u-marg-b--medium type--secondary"},l.a.createElement("p",null,Object(M.a)("subscription.modal.chatter_warning")))))),(s||c&&"listOfSites"===c)&&l.a.createElement("div",{className:"Modal-content Modal-content--forms"},l.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small"},Object(M.a)("subscription.modal.subscription_type")),l.a.createElement("div",{className:"u-marg-b--medium"},O)),o&&l.a.createElement("div",{className:"Modal-content Modal-content--forms"},l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(se.a,{title:Object(M.a)("subscription.modal.audience_change_warning.title"),type:"warning"},l.a.createElement("span",null,Object(M.a)("subscription.modal.audience_change_warning.description"))))),l.a.createElement("div",{className:"Strip Strip--modal"},l.a.createElement(U.a,{appearance:"brand",type:"submit",disabled:!t||n||a,label:Object(M.a)("subscription.modal.title_".concat(r.subscriptionId?"update":"add"))})))}}]),n}(N.b);te()(Se,"propTypes",{subscription:c.a.instanceOf(fe.a).isRequired,site:u.a.map,close:c.a.func.isRequired,initialValues:c.a.object,itemKey:c.a.string,allConditionFields:u.a.list,audienceFieldNames:u.a.list,audienceValues:u.a.map,isAudienceUpdateWarningVisible:c.a.bool,unlistedSiteCount:c.a.number,isUnlistedAdmin:c.a.bool}),te()(Se,"defaultProps",{initialValues:{},itemKey:null,isAudienceUpdateWarningVisible:null,unlistedSiteCount:0,isUnlistedAdmin:!1,onSubmit:function(){}});var we=function(e){return!!e.values&&Array.from(e.values).length>0};var Ne=Object(m.connect)((function(e,t){var n,a=t.subscription.segment||new be.b({segmentId:"org",name:Object(M.a)("all_segments.label")}),r=(a.segmentId,he(e,"subscription.segment.segmentId"),Object(ge.isCurrentUserUnlistedAdmin)(e)),c=t.subscription.getIn(["action","itemKey"]),s=t.subscription.get("membershipType"),l=t.subscription.getIn(["action","listOfItems"],new i.a.List).map((function(e){return e.get("item")})),o=l.filter((function(e){return"listOfPeople"===c||r||e.get("isListed")||e.get("isMember")})),u=l.size-o.size,m=t.subscription.audience,d=(m.listOfConditions,Object(ge.isCurrentUserAppManager)(e)),p=Object(ve.V)(e),b=he(e,"subscription.action.itemKey"),f=he(e,"subscription.action.listOfSites"),g=he(e,"subscription.membershipType"),O=(t.subscription.action.listOfItems||new i.a.List).filter((function(e){return"public"!==e.getIn(["item","access"])&&f&&f.filter((function(t){return t.get("id")===e.getIn(["item","id"])})).size>0})),v=he(e,"subscription.audience.listOfConditions")||new i.a.List,y=!t.subscription.subscriptionId&&d;return p&&d?n="everyone":p&&(n="segment"),{initialValues:{subscription:{subscriptionId:t.subscription.subscriptionId,audience:"audience"===t.subscription.recipient?m:void 0,segment:a,action:{itemKey:c,listOfSites:"listOfSites"===c&&o||new i.a.List,listOfPeople:"listOfPeople"===c&&o||new i.a.List},membershipType:s||"siteMembers"},recipient:t.subscription.recipient||n,isMandatory:"mandatory"===t.subscription.action.actionType},unlistedSiteCount:u,itemKey:b,isAudienceUpdateWarningVisible:!!t.subscription.subscriptionId&&"listOfSites"===b&&O.size>0&&!i.a.is(m.listOfConditions.filter(we),v.filter(we)),isAppManager:d,canChangeSegment:y,isSegmentsEnabled:p,isUnlistedAdmin:r,membershipType:g,recipient:he(e,"recipient"),audience:he(e,"subscription.audience"),currentSegment:a,currentSegmentName:a&&a.get("name")}}),(function(e){return{save:function(t,n){return e(Object(p.c)(t,n))}}}))(Object(ce.reduxForm)({form:Ee})(Se)),Ce=n(67),Le=n(52),xe=n(113),Me=n(73);function Pe(e){var t=e.subscription,n=e.forceClose,a=e.site,i=e.warnOnClose,r=e.onSubmit;return l.a.createElement(Ne,{subscription:t,close:n,site:a,warnOnClose:i,onSubmit:r})}Pe.propTypes={subscription:c.a.instanceOf(fe.a).isRequired,site:u.a.map};var ke={onOpen:function(e){var t=e.subscription&&e.subscription.subscriptionId;Object(Me.b)(t?Ce.Hb:Ce.zb)},onAfterClose:function(e){var t=e.subscription&&e.subscription.subscriptionId;Object(Me.b)(t?Ce.Gb:Ce.yb)}},Ae=Object(xe.a)((function(e){var t=e.subscription.subscriptionId;return{name:Le.e,title:Object(M.a)("subscription.modal.title_".concat(t?"edit":"add")),classes:["Modal--small"]}}),ke)(Pe),De=n(2664),Te=n(3520),Re=n(63),Fe=n(2939),Ue=n(31),Be=n.n(Ue),qe=n(1018),Ke=n(1003),Ve=n(227),ze=n(284);function We(e){var t=e.sub,n=e.site,a=e.deleteSubscription,r=e.isUnlistedAdmin,c=e.audience,o=e.rerunSubscription,u=t.action.listOfItems.filter((function(e){return"pending"===e.get("status")})).size>0,d=u||t.action.listOfItems.filter((function(e){return"rejected"===e.get("status")})).size>0,p=t.action.listOfItems.filter((function(e){return r||"unlisted"!==e.getIn(["item","access"])||e.getIn(["item","isMember"])})).map((function(e){return e.getIn(["item","name"])})),f=t.action.listOfItems.size-p.size,g=0===f?p:[].concat(Be()(p),[Object(M.a)("subscription.only_unlisted_site_count",{count:f})]),O=Object(m.useSelector)(ge.getCurrentUserSegmentId),v=Object(m.useSelector)(ge.getCurrentUserSegmentName),y=Object(s.useMemo)((function(){var e=t;if(!!!e.get("segment")){var n=new i.a.Map({name:v,segmentId:O});return e.set("segment",n)}return t}),[null==t?void 0:t.hashCode()]),j=l.a.createElement(Ae,{subscription:y,site:n}),E=l.a.createElement(K.a,{title:Object(M.a)("subscription.delete.label"),buttonText:Object(M.a)("common.delete"),onConfirm:function(){return a(t.subscriptionId)}},l.a.createElement("div",null,l.a.createElement("p",null,Object(M.a)("subscription.delete.still_follow_warning",{following:l.a.createElement(qe.a,{delimiter:", ",lastDelimiter:" ".concat(Object(M.a)("common.last_delimiter")," ")},g.map((function(e,t){return l.a.createElement("span",{className:"type--500",key:"".concat(t,"-").concat(e)},e)})))})),l.a.createElement("p",null,Object(M.a)("subscription.delete.warning")),l.a.createElement("p",null,Object(M.a)("common.cannot_be_undone")))),h=l.a.createElement(K.a,{title:Object(M.a)("subscription.delete_unfollow.modal_title"),buttonText:Object(M.a)("common.delete"),buttonIcon:"delete",onConfirm:function(){return a(t.subscriptionId,!0)}},l.a.createElement("div",null,l.a.createElement("p",null,Object(M.a)("subscription.delete_unfollow.warning")),l.a.createElement("ol",null,l.a.createElement("li",null,Object(M.a)("subscription.delete.label")),l.a.createElement("li",null,Object(M.a)("subscription.delete_unfollow.confirm_warning",{following:l.a.createElement(qe.a,{delimiter:", ",lastDelimiter:" ".concat(Object(M.a)("common.last_delimiter")," ")},g.map((function(e,t){return l.a.createElement("span",{className:"type--500",key:"".concat(t,"-").concat(e)},e)})))})),l.a.createElement("li",null,Object(M.a)("subscription.delete.manager_warning"))),l.a.createElement("p",null,l.a.createElement("span",{className:"type--500"},Object(M.a)("common.cannot_be_undone")))));return l.a.createElement(b.a,{modal:j},(function(e){return l.a.createElement(b.a,{modal:E},(function(n){return l.a.createElement(b.a,{modal:h},(function(a){return l.a.createElement(Ke.a,null,!u&&l.a.createElement(Ve.a,{label:Object(M.a)("common.edit"),onSelect:e}),!u&&c&&!c.isDeleted&&l.a.createElement(Ve.a,{label:Object(M.a)("subscription.re_run.label"),onSelect:function(){return o(t.subscriptionId)}}),l.a.createElement(Ve.a,{label:Object(M.a)("common.delete"),onSelect:n}),!d&&c&&!c.isDeleted&&l.a.createElement(Ve.a,{label:Object(M.a)("subscription.delete_unfollow.label"),onSelect:a}))}))}))}))}We.propTypes={sub:c.a.instanceOf(fe.a),site:c.a.instanceOf(i.a.Map),deleteSubscription:c.a.func,isUnlistedAdmin:c.a.bool,audience:c.a.instanceOf(ze.a),rerunSubscription:c.a.func};var He=We;function Je(e){var t=e.segment,n=e.site,a=e.children,r=Object(m.useSelector)(ge.isCurrentUserAppManager),c=Object(m.useSelector)(ge.isCurrentUserUnlistedAdmin),o=Object(m.useSelector)(Oe.a),u=Object(m.useSelector)(ge.getCurrentUserSegmentId),O=Object(m.useSelector)(ge.getCurrentUserSegmentName),v=t?o:r,y=Object(m.useSelector)((function(e){return Object(Re.c)(e,n)})),j=Object(m.useDispatch)(),E=t&&t.segmentId;Object(s.useEffect)((function(){r&&j(Object(d.c)())}),[]);var h,_=Object(Te.a)({initialParams:new i.a.Map({segmentId:E,siteId:n&&n.get("siteId"),excludeSegments:!E})}),I=_.subscriptions,S=_.loadMore,w=_.canPaginate,N=_.loading,C=_.loaded,L=_.prependId,P=_.removeId,k=_.reload,A=Object(s.useCallback)((function(e,t){return j(Object(p.a)(e,t)).then((function(){P(e)}))}),[]),D=Object(s.useCallback)((function(e){return j(Object(p.b)(e)).then((function(){Object(Me.b)(Ce.Mb),k()}))}),[]),T=I;if(n){var F=Object(Fe.b)(I,n.get("id"));T=F.get("approved")||new i.a.List,h=F.get("pending")}var K=t||new i.a.Map({name:O,segmentId:u}),V=l.a.createElement(Ae,{subscription:new fe.a({segment:K}),site:n,onSubmit:L}),z=y&&h;return l.a.createElement(l.a.Fragment,null,z&&l.a.createElement(W,{siteId:n.get("siteId"),subscriptions:h}),v&&l.a.createElement("div",null,z&&l.a.createElement("h1",{className:"u-floatLeft type--h4 u-marg-b--medium"},Object(M.a)("common.subscription_plural")),l.a.createElement("div",{className:"u-floatRight u-marg-b--large"},l.a.createElement(b.a,{modal:V},(function(e){return l.a.createElement(U.a,{onClick:e,appearance:"brand"},Object(M.a)("subscription.add.button"))})))),a,N&&!C?l.a.createElement(J.a,null):l.a.createElement(l.a.Fragment,null,l.a.createElement(q.a,{data:T,hasNoLastBorder:!0,isFontInherit:!0},l.a.createElement(B.a,{label:Object(M.a)("audience"),width:"35%",whiteSpaceNormal:!0},(function(e){return l.a.createElement(l.a.Fragment,null,"audience"===e.recipient&&e.audience&&l.a.createElement("div",{className:"type--fs15 type--500 u-marg-b--xsmall"},e.audience.name),l.a.createElement(g.a,{segment:e.segment||e.audience&&e.audience.segment,audience:e.audience,recipient:e.recipient}))})),l.a.createElement(B.a,{label:Object(M.a)("common.user_plural"),textAlign:"right",width:"85px",hasExtraPadding:!0},(function(e){return e.audience&&e.audience.audienceCount>0?l.a.createElement(b.a,{modal:l.a.createElement(De.a,{segmentId:e.segment?e.segment.segmentId:null,subscriptionId:e.subscriptionId})},(function(t){return l.a.createElement("button",{type:"button",className:"type--fauxLink u-textInheritColor",onClick:t},e.getIn(["audience","audienceCount"]))})):e.isLocked?"–":e.audience&&e.audience.audienceCount})),l.a.createElement(B.a,{label:Object(M.a)("listing.heading.created_by"),whiteSpaceNormal:!0},(function(e){var t=e.modifiedBy||e.createdBy;return t&&l.a.createElement("a",{href:t.get("url"),className:"u-textInheritColor"},t.get("name"))})),(!n||"public"===n.get("access"))&&l.a.createElement(B.a,{label:Object(M.a)("listing.heading.mandatory"),textAlign:"center",width:"50px",hasExtraPadding:!0},(function(e){return"mandatory"===e.getIn(["action","actionType"])&&l.a.createElement("div",{className:"Table-dot"},l.a.createElement(H.a,{isLegacy:!0,name:"record"}))})),v&&l.a.createElement(B.a,{label:Object(M.a)("common.subscription"),whiteSpaceNormal:!0},(function(e){return l.a.createElement(R,{type:e.getIn(["action","itemKey"]),items:e.getIn(["action","listOfItems"]),currentItemId:n&&n.get("siteId")||void 0,isUnlistedAdmin:c})})),v&&l.a.createElement(B.a,{width:"80px",textAlign:"right",label:Object(M.a)("manage_sites.table.options")},(function(e){return e.isLocked?l.a.createElement(x.a,{title:Object(M.a)("subscription.edit.disabled"),position:"topRight"},l.a.createElement("span",{className:"u-fill--tertiary u-floatRight",style:{width:"22px"}},l.a.createElement(H.a,{name:"lock"}))):l.a.createElement(He,{sub:e,site:n,isUnlistedAdmin:c,deleteSubscription:A,audience:e.audience,rerunSubscription:D})}))),l.a.createElement(f.a,{canLoad:w,onLoad:S,isLoading:N})))}Je.propTypes={segment:c.a.instanceOf(be.a),site:u.a.map,children:c.a.node};t.a=Je},3520:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var a=n(5),i=n.n(a),r=n(2807),c=n(2939),s=(n(478),n(275));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(){return{endpoint:e.Simpplr.Salesforce.Subscription.search,itemSelector:c.a,itemActionCreator:r.d,itemName:"subscriptions",keyName:"subscriptionId"}};function m(e){return Object(s.a)(o(o({},u()),e))}}).call(this,n(27))}}]);