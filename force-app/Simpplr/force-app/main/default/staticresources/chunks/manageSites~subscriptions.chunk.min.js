(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1244:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(53),c=n.n(s),l=n(61),u=n(2),m=n.n(u),p=n(273),d=n(252),b=n(143);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,O(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,l["b"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.data,n=e.children,a=e.hasNoLastBorder,r=e.isFontInherit,o=e.hAlignment,s=e.vAlignment,c=i.a.Children.toArray(n).filter(function(e){return!!e}),l=i.a.createElement(d.a,null,c.map(function(e,t){return i.a.createElement(b.a,{key:e.props.name||e.props.label||t,width:e.props.width,textAlign:e.props.textAlign,hasExtraPadding:e.props.hasExtraPadding},e.props.label)}));return i.a.createElement(p.a,{header:l,hasNoLastBorder:a,isFontInherit:r,hAlignment:o,vAlignment:s},t.map(function(e,t){return i.a.createElement(d.a,{key:t},c.map(function(t,n){return i.a.cloneElement(t,{item:e,key:t.props.name||t.props.label||n})}))}))}}])&&g(n.prototype,a),r&&g(n,r),t}();v.propTypes={children:o.a.node.isRequired,data:c.a.list,hasNoLastBorder:o.a.bool,isFontInherit:o.a.bool,hAlignment:o.a.oneOf(["left","center","right"]),vAlignment:o.a.oneOf(["top","bottom","middle"])},v.defaultProps={data:new m.a.List,hasNoLastBorder:!1,isFontInherit:!1,hAlignment:"left",vAlignment:"top"},t.a=v},1819:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(13),c=n(2),l=n.n(c),u=n(79),m=n(35),p=n(426),d=n(87),b=n(205),f=n(189),g=n(427),y=n(1234),O=n(1239),h=n(4);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var w=function(e){function t(e){var n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(i=j(t).call(this,e))||"object"!==v(i)&&"function"!=typeof i?_(a):i).onSearchSubmit=n.onSearchSubmit.bind(_(_(n))),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,i.a.Component),n=t,(a=[{key:"onSearchSubmit",value:function(e){this.props.onSetParams({term:e.get("term")})}},{key:"render",value:function(){var e=this.props,t=e.users,n=e.listing,a=e.canPaginate,r=e.onLoadMore,o=n.get("params",new l.a.Map),s=n.get("loading",!0)&&0===t.size&&i.a.createElement(b.a,null);return i.a.createElement("div",{className:"u-pad-b--medium"},i.a.createElement("div",{className:"row u-marg-b--xlarge"},i.a.createElement("div",{className:"large-4 column"},i.a.createElement("div",{className:"u-marg-t--medium"},i.a.createElement(g.a,{placeholder:Object(h.a)("field.people_search.label"),initialValue:o.get("term"),onSubmit:this.onSearchSubmit}))),i.a.createElement("div",{className:"large-8 column"},i.a.createElement("div",{className:"u-marg--medium"},i.a.createElement("span",{className:"toolbar-download"},i.a.createElement(f.a,{url:n.get("csvUrl")}))))),i.a.createElement("div",{className:""},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"column"},s||i.a.createElement(y.a,{itemComponent:O.a,users:t,isLoading:n.get("loading"),canPaginate:a,onLoadMore:r,showFollow:!1,showPopovers:!1})))))}}])&&E(n.prototype,a),r&&E(n,r),t}();w.propTypes={segmentId:o.a.string.isRequired,subscriptionId:o.a.string,users:o.a.instanceOf(l.a.Iterable),isLoading:o.a.bool,canPaginate:o.a.bool,onLoadMore:o.a.func},t.a=Object(d.a)(function(e){return{name:e.subscriptionId?m.xb:m.mb,id:e.subscriptionId||e.segmentId,title:e.subscriptionId?Object(h.a)("subscriptions.user_list.modal.heading"):Object(h.a)("manage_app.segments.user_list.modal.heading"),classes:["Modal--mini"]}})(Object(p.a)(u.c.users,function(e,t){return{term:t.getIn(["params","term"])||null,sortBy:"alphabetical",segmentId:e.segmentId,subscriptionId:e.subscriptionId}},function(){return!1})(Object(s.connect)(function(e,t){return{users:t.listing.get("results",new l.a.List).map(function(t){return e.getIn(["users",t,"result"])})}})(w)))},1868:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(53),c=n.n(s),l=n(61),u=n(13),m=n(2),p=n.n(m),d=n(157),b=n(320),f=n(79),g=n(1275),y=n(590),O=n(426),h=n(72),v=n(1814),E=n(19),j=n(4),I=n(206),_=n(1248),w=n(1231),S=n(262),P=n(205),N=n(38),A=n(296),C=n(15),x=n(295),L=n(42),T=n(35),M=n(87),k=n(48),U=n(25),R=n(10),F=n.n(R),B=n(1832),D=n(11),z=n(319),V=n(43),q=n(1854);function K(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=(!!n||"listOfSites"===e.getIn(["subscription","action","itemKey"]))&&e.get("isMandatory"),o=e.getIn(["subscription","action"]).set("actionType",r?"mandatory":"autofollow");if(n&&(o=o.merge({itemKey:"listOfSites",listOfSites:new p.a.List([n])})),"listOfSites"===(o=o.set("listOfItems",o.get(o.get("itemKey")).map(function(e){var n=function(e,t){return e.action.get("listOfItems").find(function(e){return e.getIn(["item","id"])===t})}(t,e.get("id"))||new p.a.Map,a=new p.a.Map({subscriptionEntityId:n.get("subscriptionEntityId")||null,item:e});return"listOfSites"===o.get("itemKey")&&(a=a.set("status",n.get("status"))||null),a})).remove("listOfSites").remove("listOfPeople")).get("itemKey")&&"listOfSites"===t.action.itemKey){var s=t.action.listOfItems.filterNot(function(e){return e.getIn(["item","isListed"])||e.getIn(["item","isMember"])});o=o.update("listOfItems",function(e){return e.concat(s)})}var c=Object(q.a)(e.getIn(["subscription","audience"]),a,!i&&"no"!==e.get("everyone")),l=e.getIn(["subscription","segment"]);return t.merge({action:o,audience:c,segment:"org"!==l.segmentId&&i?l:null})}var W=n(589),J=n(1246),G=n(1252),H=n(569),Q=n(432),X=n(1870);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t,n,a,i,r,o){try{var s=e[r](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,i)}function $(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=Object(U.formValueSelector)("ADD_SUBSCRIPTION"),re=Object(V.b)(Object(V.l)(25),Object(j.a)("subscription.site_max_reached_error",{max:25})),oe=Object(V.b)(Object(V.l)(25),Object(j.a)("subscription.user_max_reached_error",{max:25})),se=function(e){function t(){var e,n,a,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=this,i=(e=ee(t)).call.apply(e,[this].concat(o)),n=!i||"object"!==Y(i)&&"function"!=typeof i?ne(a):i,ae(ne(ne(n)),"onSubmit",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,i,r,o,s,c,l,u,m,p,d,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,i=a.subscription,r=a.close,o=a.site,s=a.audienceValues,c=a.isSegmentsEnabled,l=a.getListingId,u=a.onSubmit,m=K(t,i,o,s,c),e.next=4,n.props.save(i.subscriptionId||null,m);case 4:p=e.sent,"function"==typeof l&&(d=l({segment:p.result.segment,site:o}),n.props.prependIds(d,p.result.subscriptionId),b=l({segment:i.segment,site:o}),u(b)),n.props.warnOnClose(!1),r();case 8:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(a,i){var r=e.apply(t,n);function o(e){Z(r,a,i,o,s,"next",e)}function s(e){Z(r,a,i,o,s,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,l["b"]),n=t,(a=[{key:"componentDidUpdate",value:function(){this.props.warnOnClose(this.props.dirty&&!this.props.submitting)}},{key:"render",value:function(){var e,t=this.props,n=t.close,a=t.valid,r=t.submitting,o=t.isAnimating,s=t.handleSubmit,c=t.subscription,l=t.itemKey,u=t.site,m=t.isAudienceUpdateWarningVisible,p=t.unlistedSiteCount,d=t.isSegmentsEnabled,b=t.canChangeSegment,f=t.segmentId,g=t.change,y=F()({Form:!0,"is-disabled":r}),O=i.a.createElement(U.Field,{component:Q.a,name:"isMandatory",label:Object(j.a)("field.mandatory.label"),note:Object(j.a)("field.mandatory.note")});return e=u?Object(j.a)("subscription.modal.select_audience_for_site",{siteName:u.get("name")}):d?Object(j.a)("subscription.modal.select_audience"):Object(j.a)("subscription.modal.add_subscription"),i.a.createElement("form",{className:y,onSubmit:s(this.onSubmit)},i.a.createElement("div",{className:"Modal-content Modal-content--forms"},i.a.createElement("div",{className:"Content Content--small type--secondary"},i.a.createElement("div",{className:"u-marg-b--medium"},i.a.createElement("p",null,Object(j.a)("subscription.add.description"))),i.a.createElement(X.a,{title:e,getFormValue:ie,updateFormValue:g,size:"small",canChangeSegment:b,sectionName:"subscription",segmentId:f}),u&&i.a.createElement("div",{className:"u-marg-b--medium"},O))),!u&&i.a.createElement("div",{className:"Modal-content Modal-content--forms"},i.a.createElement("div",{className:"type--h6 type--500 u-marg-b--small"},c.subscriptionId?Object(j.a)("subscription.modal.select_".concat("listOfSites"===l?"sites":"people")):Object(j.a)("subscription.modal.select_sites_or_people")),!c.subscriptionId&&i.a.createElement("div",{className:"u-marg-b--medium"},i.a.createElement(U.Field,{component:J.a,name:"subscription.action.itemKey",validate:[V.n],isFullWidth:!1,hasLargeIcons:!0,options:[{label:Object(j.a)("common.site_plural"),value:"listOfSites",icon:"sites"},{label:Object(j.a)("common.person_plural"),value:"listOfPeople",icon:"user"}]})),l&&("listOfSites"===l?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"u-marg-b--medium"},i.a.createElement(U.Field,{component:H.a,name:"subscription.action.listOfSites",placeholder:Object(j.a)("field.site_selector.placeholder"),validate:[V.n,re],isRequired:!0,isValueModel:!0,isMulti:!0}),p>0&&i.a.createElement("div",{className:"u-marg-t--small"},"& ",Object(j.a)("subscription.only_unlisted_site_count",{count:p}))),i.a.createElement("div",{className:"u-marg-b--medium"},O)):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"u-marg-b--medium"},i.a.createElement(U.Field,{component:G.a,name:"subscription.action.listOfPeople",placeholder:Object(j.a)("field.people_selector.placeholder"),validate:[V.n,oe],isRequired:!0,isValueModel:!0,isMulti:!0})),!c.subscriptionId&&i.a.createElement("div",{className:"u-marg-b--medium type--secondary"},i.a.createElement("p",null,Object(j.a)("subscription.modal.chatter_warning")))))),m&&i.a.createElement("div",{className:"Modal-content Modal-content--forms"},i.a.createElement("div",{className:"u-marg-b--medium"},i.a.createElement(W.a,{title:Object(j.a)("subscription.modal.audience_change_warning.title"),type:"warning"},i.a.createElement("span",null,Object(j.a)("subscription.modal.audience_change_warning.description"))))),i.a.createElement("div",{className:"Strip Strip--modal"},i.a.createElement(N.a,{appearance:"brand",type:"submit",disabled:!a||r||o,label:Object(j.a)("button_label.save")}),i.a.createElement("a",{href:"",className:"Strip-cancel",onClick:n},Object(j.a)("button_label.cancel"))))}}])&&$(n.prototype,a),r&&$(n,r),t}();ae(se,"propTypes",{subscription:o.a.instanceOf(b.a).isRequired,site:c.a.map,close:o.a.func.isRequired,initialValues:o.a.object,itemKey:o.a.string,listingId:o.a.string,allConditionFields:c.a.list,audienceFieldNames:c.a.list,audienceValues:c.a.map,isAudienceUpdateWarningVisible:o.a.bool,unlistedSiteCount:o.a.number,isUnlistedAdmin:o.a.bool}),ae(se,"defaultProps",{initialValues:{},itemKey:null,listingId:null,isAudienceUpdateWarningVisible:null,unlistedSiteCount:0,isUnlistedAdmin:!1});var ce=function(e){return!!e.values&&Array.from(e.values).length>0};var le=Object(u.connect)(function(e,t){var n=t.subscription.segment||new d.b({segmentId:"org",name:Object(j.a)("subscription.modal.all_segments.label")}),a=n.segmentId,i=Object(E.isCurrentUserUnlistedAdmin)(e),r=ie(e,"subscription.segment.segmentId")||a,o=t.subscription.getIn(["action","itemKey"]),s=t.subscription.getIn(["action","listOfItems"],new p.a.List).map(function(e){return e.get("item")}),c=s.filter(function(e){return"listOfPeople"===o||i||e.get("isListed")||e.get("isMember")}),l=s.size-c.size,u=Object(v.a)(e),m=u.filter(function(e){return!e.get("isDisabled")}).first(),b=t.subscription.audience,f=b.listOfConditions;!b.listOfConditions.size&&u.size&&m&&(b=b.update("listOfConditions",function(e){return e.push(Object(z.b)({name:m.get("value"),label:m.get("label")}))})),b=b.update("listOfConditions",function(e){return e.map(function(e){return e.set("values",e.get("values").map(function(e){return e.get?e.get("id")||e.get("name"):e}))})});var g=ie(e,"subscription.action.itemKey"),y=ie(e,"subscription.action.listOfSites"),O=ie(e,"subscription.audience.listOfConditions")||new p.a.List,h=(t.subscription.action.listOfItems||new p.a.List).filter(function(e){return"public"!==e.getIn(["item","access"])&&y&&y.filter(function(t){return t.get("id")===e.getIn(["item","id"])}).size>0}),I=Object(E.isCurrentUserAppManager)(e),_=Object(D.D)(e),w=!t.subscription.subscriptionId&&I;return{initialValues:{subscription:{subscriptionId:t.subscription.subscriptionId,segment:n,audience:b,action:{itemKey:o,listOfSites:"listOfSites"===o&&c||new p.a.List,listOfPeople:"listOfPeople"===o&&c||new p.a.List}},isMandatory:"mandatory"===t.subscription.action.actionType,everyone:0===f.size?"yes":"no"},unlistedSiteCount:l,itemKey:g,allConditionFields:u,audienceFieldNames:O.map(function(e){return e.get("name")}),audienceValues:Object(B.a)(e,r),isAudienceUpdateWarningVisible:!!t.subscription.subscriptionId&&"listOfSites"===g&&h.size>0&&!p.a.is(b.listOfConditions.filter(ce),O.filter(ce)),canChangeSegment:w,isSegmentsEnabled:_,isUnlistedAdmin:i,everyone:"yes"===ie(e,"subscription.audience.everyone"),segmentId:r}},function(e){return{save:function(t,n){return e(Object(g.b)(t,n))},prependIds:function(t,n){return e(Object(f.e)(t,n))}}})(Object(U.reduxForm)({form:"ADD_SUBSCRIPTION"})(se));function ue(e){var t=e.subscription,n=e.forceClose,a=e.site,r=e.getListingId,o=e.warnOnClose,s=e.onSubmit;return i.a.createElement(le,{subscription:t,close:n,site:a,getListingId:r,warnOnClose:o,onSubmit:s})}ue.propTypes={subscription:o.a.instanceOf(b.a).isRequired,site:c.a.map,getListingId:o.a.func};var me={onOpen:function(e){var t=e.subscription&&e.subscription.subscriptionId;Object(k.b)(t?L.SUBSCRIPTION_EDIT_MODAL_OPEN:L.SUBSCRIPTION_ADD_MODAL_OPEN)},onAfterClose:function(e){var t=e.subscription&&e.subscription.subscriptionId;Object(k.b)(t?L.SUBSCRIPTION_EDIT_MODAL_CLOSE:L.SUBSCRIPTION_ADD_MODAL_CLOSE)}},pe=Object(M.a)(function(e){var t=e.subscription.subscriptionId;return{name:T.b,title:Object(j.a)("subscription.modal.title_".concat(t?"edit":"add")),classes:["Modal--small"]}},me)(ue),de=n(1819),be=n(164),fe=n(92),ge=n(340);function ye(e){var t,n=e.status,a=n;return"rejected"===n?t="negative":"pending"===n&&(t="warning"),t?i.a.createElement(ge.a,{text:Object(j.a)("status.".concat(a)),status:t}):null}ye.propTypes={status:o.a.string},ye.defaultProps={};var Oe=ye;function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ee(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ee(this,je(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,l["b"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.items,n=e.currentItemId,a=e.type,r=e.isUnlistedAdmin,o=0,s=t.filter(function(e){var t="listOfPeople"===a||r||e.getIn(["item","isListed"])||e.getIn(["item","isMember"]);return t||(o+=1),t});return i.a.createElement(be.a,{isStacked:!0},s.sortBy(function(e){var t=e.getIn(["item","name"]);return n?"".concat(e.getIn(["item","id"])!==n,"-").concat(t):t}).map(function(e){var t=e.getIn(["item","id"]),r=e.getIn(["item","name"]),o=t===n,s=!e.getIn(["item","isActive"])||e.getIn(["item","isChatterGroupOnly"]),c=i.a.createElement("a",{href:e.getIn(["item","url"]),className:"u-textInheritColor"},r);return s?c=i.a.createElement(A.a,{title:Object(j.a)("".concat("listOfPeople"===a?"user":"site",".inactive_tooltip")),isInline:!0},i.a.createElement("span",{className:"type--tertiary u-lineThrough"},c)):n&&!o?c=i.a.createElement("span",{className:"type--tertiary"},c):"public"!==e.getIn(["item","access"])&&"approved"===e.get("status")&&e.get("actionedBy")&&(c=i.a.createElement(A.a,{title:Object(j.a)("subscription.approved_by",{name:e.getIn(["actionedBy","name"])}),isInline:!0},c)),i.a.createElement(fe.a,{key:t},i.a.createElement("div",{className:"u-marg-b--xsmall"},c,i.a.createElement("span",{className:"u-hideIfEmpty u-marg-l--xsmall"},i.a.createElement(Oe,{status:e.get("status")}))))}),o>0&&i.a.createElement(fe.a,null,i.a.createElement("div",{className:"u-marg-b--xsmall"},Object(j.a)("subscription.".concat(s.size<=0?"only_":"","unlisted_site_count"),{count:o}))))}}])&&ve(n.prototype,a),r&&ve(n,r),t}();_e.propTypes={items:c.a.list,currentItemId:o.a.string,type:o.a.oneOf(["listOfSites","listOfPeople"]).isRequired,isUnlistedAdmin:o.a.bool},_e.defaultProps={items:new p.a.List,isUnlistedAdmin:!1};var we=_e,Se=n(88),Pe=n(67),Ne=n(1805),Ae=n(1244),Ce=n(443);function xe(e){var t=e.approve,n=e.reject,r=e.subscriptions;return i.a.createElement("div",{className:"Box Box--gray u-marg-b--xlarge u-pad-t--medium u-pad-l--medium u-pad-r--medium u-borderRadius--4"},i.a.createElement("h2",{className:"type--h4 u-marg-b--medium"},Object(j.a)("subscription.pending")),i.a.createElement(Ae.a,{data:r,hasNoLastBorder:!0,isFontInherit:!0},i.a.createElement(Ce.a,{label:Object(j.a)("audience"),width:"35%"},function(e){return i.a.createElement(Ne.a,{segment:e.segment,audience:e.audience})}),i.a.createElement(Ce.a,{name:"audience.audienceCount",label:Object(j.a)("common.user_plural"),textAlign:"right",width:"80px",hasExtraPadding:!0}),i.a.createElement(Ce.a,{label:Object(j.a)("listing.heading.created_by"),width:"30%",hasExtraPadding:!0},function(e){var t=e.modifiedBy||e.createdBy;return i.a.createElement("a",{href:t.get("url"),className:"u-textInheritColor"},t.get("name"))}),i.a.createElement(Ce.a,{label:Object(j.a)("listing.heading.actions"),textAlign:"right"},function(e){return i.a.createElement(a.Fragment,null,i.a.createElement("span",{className:"u-marg-r--small"},i.a.createElement(I.a,{modal:i.a.createElement(x.a,{title:Object(j.a)("subscription.reject_modal.title"),buttonText:Object(j.a)("button_label.reject"),onConfirm:function(){return n(e.subscriptionId)},classes:["Modal--small"]},i.a.createElement("p",null,Object(j.a)("subscription.reject_modal.intro")),i.a.createElement(Ne.a,{segment:e.segment,audience:e.audience}),i.a.createElement("p",null,Object(j.a)("common.cannot_be_undone")))},function(e){return i.a.createElement(N.a,{label:Object(j.a)("button_label.reject"),onClick:e,appearance:"danger",size:"small"})})),i.a.createElement(I.a,{modal:i.a.createElement(x.a,{title:"mandatory"===e.action.actionType?Object(j.a)("subscription.approve_modal.title_mandatory"):Object(j.a)("subscription.approve_modal.title"),buttonText:Object(j.a)("button_label.approve"),onConfirm:function(){return t(e.subscriptionId)},classes:["Modal--small"]},i.a.createElement("div",{className:"type--primary"},i.a.createElement("p",null,Object(j.a)("subscription.approve_modal.intro")),i.a.createElement(Ne.a,{segment:e.segment,audience:e.audience,showMandatory:"mandatory"===e.action.actionType,showAudienceCount:!0}),i.a.createElement("div",{className:"u-border-top u-pad-t--small"},i.a.createElement("p",null,Object(j.a)("subscription.approve_modal.result_in")),i.a.createElement("ul",null,i.a.createElement("li",null,Object(j.a)("subscription.approve_modal.consequence1")),i.a.createElement("li",null,Object(j.a)("subscription.approve_modal.consequence2")),"mandatory"===e.action.actionType&&i.a.createElement("li",null,Object(j.a)("subscription.approve_modal.consequence3"))),i.a.createElement("p",{className:"type--500"},Object(j.a)("subscription.approve_modal.warning")))))},function(e){return i.a.createElement(N.a,{label:Object(j.a)("button_label.approve"),onClick:e,icon:!1,appearance:"confirm",size:"small"})}))})))}xe.propTypes={siteId:o.a.string.isRequired,subscriptions:c.a.listOf(Se.a.subscription).isRequired,approve:o.a.func.isRequired,reject:o.a.func.isRequired},xe.defaultProps={};var Le=Object(u.connect)(null,function(e,t){return{approve:function(n){return e(Object(Pe.approveSubscription)(t.siteId,n))},reject:function(n){return e(Object(Pe.rejectSubscription)(t.siteId,n))}}})(xe),Te=n(286);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ue(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Re(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ze=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Re(this,Fe(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(t,l["b"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.sub,n=e.site,a=e.getListingId,r=e.reloadListing,o=e.isUnlistedAdmin,s=e.deleteSubscription,c=t.action.listOfItems.filter(function(e){return"pending"===e.get("status")}).size>0,l=c||t.action.listOfItems.filter(function(e){return"rejected"===e.get("status")}).size>0,u=t.action.listOfItems.filter(function(e){return o||"unlisted"!==e.getIn(["item","access"])||e.getIn(["item","isMember"])}).map(function(e){return e.getIn(["item","name"])}),m=t.action.listOfItems.size-u.size,p=0===m?u:[].concat(ke(u),[Object(j.a)("subscription.only_unlisted_site_count",{count:m})]),d=i.a.createElement(pe,{subscription:t,site:n,getListingId:a,onSubmit:r}),b=i.a.createElement(x.a,{title:Object(j.a)("subscription.delete.label"),buttonText:Object(j.a)("common.delete"),onConfirm:function(){return s(t.subscriptionId)}},i.a.createElement("div",null,i.a.createElement("p",null,Object(j.a)("subscription.delete.still_follow_warning",{following:i.a.createElement(_.a,{delimiter:", ",lastDelimiter:" ".concat(Object(j.a)("common.last_delimiter")," ")},p.map(function(e,t){return i.a.createElement("span",{className:"type--500",key:t},e)}))})),i.a.createElement("p",null,Object(j.a)("subscription.delete.warning")),i.a.createElement("p",null,Object(j.a)("common.cannot_be_undone")))),f=i.a.createElement(x.a,{title:Object(j.a)("subscription.delete_unfollow.modal_title"),buttonText:Object(j.a)("common.delete"),buttonIcon:"delete",onConfirm:function(){return s(t.subscriptionId,!0)}},i.a.createElement("div",null,i.a.createElement("p",null,Object(j.a)("subscription.delete_unfollow.warning")),i.a.createElement("ol",null,i.a.createElement("li",null,Object(j.a)("subscription.delete.label")),i.a.createElement("li",null,Object(j.a)("subscription.delete_unfollow.confirm_warning",{following:i.a.createElement(_.a,{delimiter:", ",lastDelimiter:" ".concat(Object(j.a)("common.last_delimiter")," ")},p.map(function(e,t){return i.a.createElement("span",{className:"type--500",key:t},e)}))})),i.a.createElement("li",null,Object(j.a)("subscription.delete.manager_warning"))),i.a.createElement("p",null,i.a.createElement("span",{className:"type--500"},Object(j.a)("common.cannot_be_undone")))));return i.a.createElement(I.a,{modal:d},function(e){return i.a.createElement(I.a,{modal:b},function(t){return i.a.createElement(I.a,{modal:f},function(n){return i.a.createElement(w.a,null,!c&&i.a.createElement(S.a,{label:Object(j.a)("common.edit"),onSelect:e}),i.a.createElement(S.a,{label:Object(j.a)("common.delete"),onSelect:t}),!l&&i.a.createElement(S.a,{label:Object(j.a)("subscription.delete_unfollow.label"),onSelect:n}))})})})}}])&&Ue(n.prototype,a),r&&Ue(n,r),t}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ke(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}De(ze,"propTypes",{sub:o.a.instanceOf(b.a),site:c.a.map,getListingId:o.a.func,reloadListing:o.a.func,deleteSubscription:o.a.func,isUnlistedAdmin:o.a.bool}),De(ze,"defaultProps",{});var Ge=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ke(this,We(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,l["b"]),n=t,(r=[{key:"componentDidMount",value:function(){this.props.isAppManager&&this.props.loadAllSegments()}},{key:"render",value:function(){var e=this,t=this.props,n=t.segment,r=t.listing,o=t.subscriptions,s=t.site,c=t.canManage,l=t.canManageSite,u=t.pendingSubscriptions,m=t.canPaginate,p=t.onLoadMore,d=t.children,f=t.isUnlistedAdmin,g=t.reloadListing,y=i.a.createElement(pe,{subscription:new b.a({segment:n}),site:s,getListingId:He,onSubmit:g});return i.a.createElement(a.Fragment,null,l&&u.size>0&&i.a.createElement(Le,{siteId:s.get("siteId"),subscriptions:u}),c&&i.a.createElement("div",{className:"u-floatRight u-marg-b--large"},i.a.createElement(I.a,{modal:y},function(e){return i.a.createElement(N.a,{onClick:e,appearance:"brand"},Object(j.a)("subscription.add.button"))})),d,r.get("loaded")?i.a.createElement(a.Fragment,null,i.a.createElement(Ae.a,{data:o,hasNoLastBorder:!0,isFontInherit:!0},i.a.createElement(Ce.a,{label:Object(j.a)("audience"),width:"35%"},function(e){return i.a.createElement(Ne.a,{segment:e.segment,audience:e.audience})}),i.a.createElement(Ce.a,{label:Object(j.a)("common.user_plural"),textAlign:"right",width:"85px",hasExtraPadding:!0},function(e){return e.audience.audienceCount>0?i.a.createElement(I.a,{modal:i.a.createElement(de.a,{segmentId:e.segment?e.segment.segmentId:null,subscriptionId:e.subscriptionId})},function(t){return i.a.createElement("button",{type:"button",className:"type--fauxLink u-textInheritColor",onClick:t},e.getIn(["audience","audienceCount"]))}):e.isLocked?"–":e.audience.audienceCount}),i.a.createElement(Ce.a,{label:Object(j.a)("listing.heading.created_by")},function(e){var t=e.modifiedBy||e.createdBy;return t&&i.a.createElement("a",{href:t.get("url"),className:"u-textInheritColor"},t.get("name"))}),(!s||"public"===s.get("access"))&&i.a.createElement(Ce.a,{label:Object(j.a)("listing.heading.mandatory"),textAlign:"center",width:"50px",hasExtraPadding:!0},function(e){return"mandatory"===e.getIn(["action","actionType"])&&i.a.createElement("div",{className:"Table-dot"},i.a.createElement(C.a,{isLegacy:!0,name:"record"}))}),c&&i.a.createElement(Ce.a,{label:Object(j.a)("common.subscription")},function(e){return i.a.createElement(we,{type:e.getIn(["action","itemKey"]),items:e.getIn(["action","listOfItems"]),currentItemId:s&&s.get("siteId")||void 0,isUnlistedAdmin:f})}),c&&i.a.createElement(Ce.a,{width:"28px",textAlign:"right"},function(t){return t.isLocked?i.a.createElement(A.a,{title:Object(j.a)("subscription.edit.disabled"),position:"topRight"},i.a.createElement("span",{className:"u-fill--tertiary u-floatRight",style:{width:"22px"}},i.a.createElement(C.a,{name:"lock"}))):i.a.createElement(ze,{sub:t,site:s,getListingId:He,reloadListing:g,isUnlistedAdmin:f,deleteSubscription:e.props.deleteSubscription})})),i.a.createElement(Te.a,{canLoad:m,onLoad:p,isLoading:r.get("loading")})):i.a.createElement(P.a,{hasNoBorder:!0}))}}])&&qe(n.prototype,r),o&&qe(n,o),t}();function He(e){var t=e.site,n=e.segment;return"subscriptionListing-".concat(n&&n.segmentId||"org","-").concat(t&&t.get("siteId")||"all")}Ge.propTypes={segment:o.a.instanceOf(d.a),subscriptions:c.a.listOf(o.a.instanceOf(b.a)),site:c.a.map,canManage:o.a.bool,isUnlistedAdmin:o.a.bool},Ge.defaultProps={subscriptions:new p.a.List,canManage:!1,isUnlistedAdmin:!1};t.a=Object(O.a)(f.c.subscriptions,function(e){var t=e.segment,n=e.site,a=t&&t.segmentId;return{segmentId:a,siteId:n&&n.get("siteId"),excludeSegments:!a}},null,He)(Object(u.connect)(function(e,t){var n=Object(v.b)(e,t.listingId),a=new p.a.List,i=t.site;if(i){var r=Object(v.c)(n,i.get("id"));n=r.get("approved")||new p.a.List,a=r.get("pending")||new p.a.List}var o=Object(E.isCurrentUserAppManager)(e);return{subscriptions:n,pendingSubscriptions:a,canManage:t.segment?Object(h.a)(e):o,canManageSite:i&&(o||i.get("isManager")),isUnlistedAdmin:Object(E.isCurrentUserUnlistedAdmin)(e),isAppManager:o}},{deleteSubscription:g.a,loadAllSegments:y.c,reloadListing:f.f})(Ge))},443:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(53),c=n.n(s),l=n(143);function u(e){var t=e.name,n=e.item,a=e.children,r=e.width,o=e.textAlign,s=e.hasExtraPadding,c=null;if(a)c=a(n);else{var u=Array.isArray(t)?t:t.split(".");c=n.getIn(u)}return i.a.createElement(l.a,{width:r,textAlign:o,hasExtraPadding:s},c)}u.propTypes={width:o.a.oneOfType([o.a.string,o.a.number]),name:o.a.string,children:o.a.func,item:c.a.iterable,textAlign:l.a.propTypes.textAlign,hasExtraPadding:l.a.propTypes.hasExtraPadding},u.defaultProps={width:null},t.a=u}}]);