(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{2070:function(e,t,n){"use strict";(function(e){n.d(t,"k",(function(){return g})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"o",(function(){return j})),n.d(t,"a",(function(){return S})),n.d(t,"g",(function(){return I})),n.d(t,"m",(function(){return L})),n.d(t,"j",(function(){return E})),n.d(t,"h",(function(){return N})),n.d(t,"i",(function(){return P})),n.d(t,"b",(function(){return F})),n.d(t,"c",(function(){return k})),n.d(t,"f",(function(){return _})),n.d(t,"n",(function(){return x}));var r=n(41),a=n(78),i=n(72),l=n(14),o=n(66),c=n(34),s=n(27),u=n(106),d=n(112),f=n(128),p=n(3),m=n(200),b=n(2108);function y(e,t,n,r){var i=r.status,o=i!==t,c=r.site&&!r.site.isActive;if(o||c){var s=Object(p.a)("common.not_possible_to_perform_action");return o&&("sent"===i?s+=" - ".concat(Object(p.a)("newsletter.action.already_sent.error_flash")):"deleted"===i?s+=" - ".concat(Object(p.a)("newsletter.action.already_deleted.error_flash")):"on_hold"===i?s+=" - ".concat(Object(p.a)("newsletter.action.on_hold.error_flash")):"draft"===i&&(s+=" - ".concat(Object(p.a)("newsletter.action.being_edited.error_flash")))),n(Object(l.f)(s)),n(w(r)),n({type:a.d,payload:{newsletterId:e}}),Object(u.e)({pathname:"/newsletter"}),!1}return!0}function w(e){return{type:a.D,payload:{newsletterId:e.newsletterId,result:e}}}function g(e){return Array.isArray(e)?function(t){e.forEach((function(e){return t(w(e))}))}:w(e)}function O(t){return function(n){n({type:a.p,payload:{newsletterId:t}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.get(t).done((function(e){n({type:a.q,payload:{newsletterId:t,result:e.result}})})).fail((function(e){var r=Object(s.a)(e);n(Object(l.f)(r)),n({type:a.o,error:r,payload:{newsletterId:t}})})).always(e.Simpplr.Loader.hide)}}function h(){return function(t){t({type:a.m}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Site.search({filter:"canCreateNewsletter",size:999999}).done((function(e){t({type:a.n,payload:{result:e.result}})})).fail((function(e){var n=Object(s.a)(e);t(Object(l.f)(n)),t({type:a.l,error:n})})).always(e.Simpplr.Loader.hide)}}function v(t,n,r,i,o,c,u){return function(d){return r||o||c?(e.Simpplr.Loader.show(),r?e.Simpplr.Salesforce.Site.get(r).done((function(e){d({type:a.E,payload:{newsletterId:t,recipient:n,membersType:u,site:e.result}})})).fail((function(e){var t=Object(s.a)(e);d(Object(l.f)(t)),d({type:a.l,error:t})})).always(e.Simpplr.Loader.hide):c?e.Simpplr.Salesforce.Segment.get(c).done((function(e){d({type:a.E,payload:{newsletterId:t,recipient:n,membersType:u,segment:e.result}})})).fail((function(e){var t=Object(s.a)(e);d(Object(l.f)(t)),d({type:a.k,error:t})})).always(e.Simpplr.Loader.hide):e.Simpplr.Salesforce.Audience.get(o).done((function(e){d({type:a.E,payload:{newsletterId:t,recipient:n,membersType:u,audience:e.result}})})).fail((function(e){var t=Object(s.a)(e);d(Object(l.f)(t)),d({type:a.j,error:t})})).always(e.Simpplr.Loader.hide)):(d({type:a.E,payload:{newsletterId:t,recipient:n,numberOfOrgUsers:i}}),Promise.resolve({}))}}function j(t,n,a){return function(i){var o;return!(!(o=a?n.get("imgLandscapeFile"):n.get("imgFile"))||!Object(b.a)(n))&&(i(Object(r.startSubmit)(t)),e.Simpplr.Salesforce.Newsletter.uploadImageToAWS(o.get("contentVersionId")).fail((function(e){var t=Object(s.a)(e);i(Object(l.f)(t))})).always((function(){i(Object(r.stopSubmit)(t))})))}}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(a){a(Object(r.arrayPush)(e,"items",new m.a({id:"temp".concat(Object(f.a)()),type:t,content:n})))}}function I(t,n){return function(r){return r({type:a.s,payload:{newsletterId:t,data:n}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.saveDraft(n.toJS()).done((function(e){r(Object(l.j)(Object(p.a)("newsletter.action.save_draft.success_flash"))),r({type:a.t,payload:{newsletterId:e.result.newsletterId,result:e.result,data:n}})})).fail((function(e){var n=Object(s.a)(e);r(Object(l.f)(n)),e.result&&r(w(e.result)),r({type:a.r,payload:{newsletterId:t,error:n}})})).always(e.Simpplr.Loader.hide)}}function L(t,n,r){return function(i){return i({type:a.G,payload:{newsletterId:t}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.update(t,n.toJS()).done((function(e){var o=!0===r?Object(p.a)("newsletter.action.save.success_flash"):Object(p.a)("newsletter.action.update.success_flash");i(Object(l.j)(o)),i({type:a.H,payload:{newsletterId:t,result:e.result,data:n}})})).fail((function(e){var n=Object(s.a)(e);i(Object(l.f)(n)),e.result&&i(w(e.result)),i({type:a.F,newsletterId:t,error:n})})).always(e.Simpplr.Loader.hide)}}function E(t,n,r){return function(i){return i({type:a.B,payload:{data:n}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.sendPreview(t,n.toJS(),r).done((function(e){i(Object(l.j)(Object(p.a)("newsletter.action.send_preview.success_flash"))),i({type:a.C,payload:{newsletterId:t,result:e.result,data:n}})})).fail((function(e){var n=Object(s.a)(e);i(Object(l.f)(n)),e.result&&i(w(e.result)),i({type:a.A,payload:{newsletterId:t,error:n}})})).always(e.Simpplr.Loader.hide)}}function N(t,n){return function(r){return r({type:a.v,payload:{newsletterId:t}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.schedule(t,n.toJS()).done((function(e){var o=Object(c.i)(n.get("sendAt")),s=Object(p.a)("newsletter.action.schedule.success_flash",{date:o.format(Object(c.n)(i.g))});r(Object(l.j)(s)),r({type:a.w,payload:{newsletterId:t,result:e.result,data:n}})})).fail((function(e){var n=Object(s.a)(e);r(Object(l.f)(n)),e.result&&r(w(e.result)),r({type:a.u,payload:{newsletterId:t,error:n}})})).always(e.Simpplr.Loader.hide)}}function P(t,n){return function(r){return r({type:a.y,newsletterId:t}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.sendNow(t,n).done((function(e){y(t,"sent",r,e.result)&&(r(Object(l.j)(Object(p.a)("newsletter.action.send.success_flash"))),r({type:a.z,payload:{newsletterId:t,result:e.result}}))})).fail((function(e){var n=Object(s.a)(e);r(Object(l.f)(n)),e.result&&r(w(e.result)),r({type:a.x,payload:{newsletterId:t,error:n}})})).always(e.Simpplr.Loader.hide)}}function F(t){return function(n){return n({type:a.b,payload:{newsletterId:t}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.delete(t).done((function(){n(Object(l.j)(Object(p.a)("newsletter.action.delete.success_flash"))),n({type:a.c,payload:{newsletterId:t}})})).fail((function(e){var r=Object(s.a)(e);n(Object(l.f)(r)),n({type:a.a,payload:{newsletterId:t,error:r}})})).always(e.Simpplr.Loader.hide)}}function k(t){return function(n){return n({type:a.e,payload:{newsletterId:t}}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Newsletter.edit(t).then((function(e){if(y(t,"draft",n,e.result)){var r=n({type:a.f,payload:{newsletterId:t}});return n(w(e.result)),r}return!1})).fail((function(e){var t=Object(s.a)(e);n(Object(l.f)(t)),e.result&&n(w(e.result)),n({type:a.d,payload:t,error:!0})})).always(e.Simpplr.Loader.hide)}}function _(){return function(t){return t({type:a.h}),e.Simpplr.Loader.show(),e.Simpplr.Salesforce.Utility.getFromAddresses().then((function(e){t({type:a.i,payload:{fromAddresses:e.result.listOfItems}})})).fail((function(e){var n=Object(s.a)(e);t({type:a.g,payload:n,error:!0})})).always(e.Simpplr.Loader.hide)}}function x(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(o.upload)(t,!1,n,{endpoint:e.Simpplr.Salesforce.Newsletter.upload,getFileParams:function(e){return Object(d.b)(e.base64,e.type)}})}}).call(this,n(28))},2108:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"i",(function(){return w})),n.d(t,"a",(function(){return g}));var r,a=n(2),i=n.n(a),l=n(15),o=n(84),c=function(e){return e.getIn(["newsletter","newsletters"])||new i.a.List},s=Object(l.a)([c],(function(e){return e.map((function(e){return e.get("result")}))})),u=Object(l.a)([c,function(e,t){return t}],(function(e,t){return e.get(t)})),d=function(e,t){return e.getIn(["newsletter","newsletters",t,"result"],new i.a.Map)},f=(Object(l.a)([(r="newsletter",function(e,t){return{loaded:e.getIn([r,t,"loaded"],!1),loading:e.getIn([r,t,"loading"],!1),isFullModel:e.getIn([r,t,"isFullModel"],!1),error:e.getIn([r,t,"error"],null)}}),d],(function(e,t){return Object.assign(e,{newsletter:t})})),Object(l.a)([s,function(e,t){return new i.a.List(t)}],(function(e,t){return t.map((function(t){return e.get(t)})).filter((function(e){return!!e}))})));function p(e){return!!e.find((function(e){return"content"===e.type&&("published"!==e.getIn(["content","status"])||!e.getIn(["content","isTypeActive"],!0)||e.getIn(["content","isDeleted"])||!e.getIn(["content","site","isActive"],!0))}))}function m(e){return!!e.find((function(e){return"content"===e.type&&(e.isShowcase&&e.content.getIn(["imgLandscapeFile","size"])>o.i||!e.isShowcase&&e.content.getIn(["imgFile","size"])>o.i)}))}function b(e){return e.getIn(["newsletter","fromAddresses","result"])||new i.a.List}function y(e){return e.getIn(["newsletter","fromAddresses","loaded"])&&0===b(e).size}function w(e){return e.getIn(["newsletter","fromAddresses","loading"])}function g(e){return"published"===e.get("status")&&!e.get("isDeleted")&&e.get("isTypeActive")&&(!e.get("site")||e.getIn(["site","isActive"]))}},2188:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var r=n(4),a=n.n(r),i=n(31),l=n.n(i),o=n(0),c=n(1657),s=n(2189),u=n(480);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e,t){var n=Object(o.useState)([]),r=l()(n,2),a=r[0],i=r[1];return{filterSites:a,resultExtractor:function(n,r){var a=n.result,l=a.listOfItems,o=a.filterOptions.sites;return r(e(l)),i(o||[]),l.map((function(e){return e[t]}))}}};function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=p(c.j,"alertId"),r=n.resultExtractor,a=n.filterSites,i=Object(u.a)(f({endpoint:e.Simpplr.Salesforce.Alert.search,resultExtractor:r,itemSelector:s.a,itemName:"alerts"},t));return f(f({},i),{},{filterSites:a})}}).call(this,n(28))},2189:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),a=n.n(r),i=n(15);function l(e){return e.getIn(["alert","alerts"])}var o=Object(i.a)([l],(function(e){return e.map((function(e){return e.get("result")}))})),c=(Object(i.a)([l,function(e,t){return t}],(function(e,t){return e.get(t)})),Object(i.a)([o,function(e,t){return new a.a.List(t)}],(function(e,t){return t.map((function(t){return e.get(t)})).filter((function(e){return!!e}))})))},2299:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r=n(4),a=n.n(r),i=n(2070),l=n(2108),o=n(480),c=n(2188);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){var t=u({},e);return"all"===t.filter&&(t.filter=void 0),"any"===t.recipient&&(t.recipient=void 0),t}function f(t){var n=Object(c.b)(i.k,"newsletterId"),r=n.filterSites,a=n.resultExtractor,s=Object(o.a)(u({endpoint:e.Simpplr.Salesforce.Newsletter.search,itemSelector:l.e,itemName:"newsletters",requestTransformer:d,resultExtractor:a},t));return u(u({},s),{},{filterSites:r})}}).call(this,n(28))},2418:function(e,t,n){"use strict";var r=n(31),a=n.n(r),i=n(0),l=n.n(i),o=n(1),c=n.n(o),s=n(2),u=n.n(s),d=n(62),f=n.n(d),p=n(59),m=n(2033),b=n(129),y=n(3),w=n(24),g=n(643),O=n(512),h=n(9),v=n.n(h),j=n(10),S=n.n(j),I=n(11),L=n.n(I),E=n(12),N=n.n(E),P=n(8),F=n.n(P),k=n(4),_=n.n(k),x=n(89),T=n(1647),D=n(83),A=n(268),R=n(237),C=n(7),z=n.n(C),M=n(16),q=n.n(M);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=F()(e);if(t){var a=F()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return N()(this,n)}}var J=function(e){L()(n,e);var t=B(n);function n(){var e;v()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(z()(e),"render",(function(){var t=e.props,n=t.onClick,r=t.children,a=t.isSelected,i=t.isDisabled,o=t.value,c=t.disabledLabel,s=t.isRadio,u=q()({SelectionItem:!0,"is-active":a,"is-disabled":i}),d=q()({"SelectionItem-overlay":!0,"theme--border":a});return l.a.createElement("button",{type:"button",className:u,onClick:n},l.a.createElement("div",{className:d}),l.a.createElement("div",{className:"SelectionItem-checkbox"},l.a.createElement("div",{className:"ToggleField ToggleField--checkbox u-inlineBlock"},l.a.createElement("input",{className:"ToggleField-input ToggleField-input--checkbox",name:"files",type:s?"radio":"checkbox",onChange:e.checkBoxClicked,checked:a}),l.a.createElement("span",{className:"ToggleField-button ToggleField-button--checkbox-input"},l.a.createElement(w.a,{name:"check-input",sourceSize:"18"})))),a&&o&&l.a.createElement("div",{className:"SelectionItem-number theme--bg type--500"},o),l.a.createElement("div",{className:"SelectionItem-inner"},i&&l.a.createElement("div",{className:"SelecttionItem-disabledLabel"},c||Object(y.a)("selection_item.disabled_label")),r))})),e}return n}(l.a.PureComponent);_()(J,"propTypes",{children:c.a.node.isRequired,onClick:c.a.func.isRequired,value:c.a.oneOfType([c.a.number,c.a.bool]),isDisabled:c.a.bool,isSelected:c.a.bool,disabledLabel:c.a.string}),_()(J,"defaultProps",{isDisabled:!1,isSelected:!1});var U=J;function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=F()(e);if(t){var a=F()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return N()(this,n)}}var G=function(e){L()(n,e);var t=W(n);function n(){return v()(this,n),t.apply(this,arguments)}return S()(n,[{key:"render",value:function(){var e=this.props,t=e.selected,n=e.onSelect,r=e.exclude,a=e.hasSiteImageFallback,i=e.hideFollowingTopics,o=e.hideTypeStamps,c=e.canPaginate,s=e.onLoadMore,u=e.isLoading,d=e.content;if(0===d.size)return u?l.a.createElement(R.a,{hasBorder:!0}):l.a.createElement(D.a,null);var f=d.map((function(e){return l.a.createElement("div",{className:"u-border-bottom",key:e.get("id")},l.a.createElement(U,{onClick:function(){return n(e.get("id"))},isDisabled:r.includes(e.get("id")),isSelected:t.contains(e.get("id")),value:t.includes(e.get("id"))&&t.indexOf(e.get("id"))+1},l.a.createElement(T.a,{hasSiteImageFallback:a,showFavorite:!1,content:e,hideFollowingTopics:i,hideTypeStamp:o,key:e.get("id"),size:"small"})))}));return l.a.createElement("div",null,l.a.createElement("ul",null,f),l.a.createElement(A.a,{canLoad:c,onLoad:s,isLoading:u}))}}]),n}(x.b);_()(G,"propTypes",{content:c.a.instanceOf(u.a.List).isRequired,exclude:c.a.instanceOf(u.a.List),isLoading:c.a.bool,canPaginate:c.a.bool.isRequired,onLoadMore:c.a.func.isRequired,hideFollowingTopics:c.a.bool,hideTypeStamps:c.a.bool,showFavorite:c.a.bool,hasSiteImageFallback:c.a.bool}),_()(G,"defaultProps",{exclude:new u.a.List,hideTypeStamps:!1,hideFollowingTopics:!0,showFavorite:!1,hasSiteImageFallback:!1,isLoading:!1});var H=G,V=n(68);function K(e){var t=e.site,n=e.onSubmit,r=e.close,o=e.exclude,c=e.excludePrivate,s=Object(m.a)({initialParams:new u.a.Map({siteId:t?t.get("siteId"):void 0,filter:"canAddToNewsletterFromSite",sortBy:"latest",type:"all"})}),d=s.content,f=s.loading,p=s.loadMore,b=s.canPaginate,h=s.params,v=s.setParams,j=Object(i.useState)(new u.a.List),S=a()(j,2),I=S[0],L=S[1],E=[{value:"all",label:Object(y.a)("common.all")},{value:"page",label:Object(y.a)("common.page")},{value:"event",label:Object(y.a)("common.event")},{value:"album",label:Object(y.a)("common.album")},!h.get("siteId")&&{value:"BlogPost",label:Object(y.a)("common.blog")}].filter((function(e){return!!e}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"Modal-content"},l.a.createElement("div",{className:"row row--autoWidth join"},l.a.createElement("div",{className:"large-8 column"},l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement(O.a,{selected:new u.a.List([t]),placeholder:Object(y.a)("field.site_selector.placeholder"),onChange:function(e){var t={siteId:e};"BlogPost"===h.get("type")&&(t.type="all"),L(new u.a.List),v(t)},excludePrivate:c}))),l.a.createElement("div",{className:"large-4 column"},l.a.createElement("div",{className:"u-marg-b--medium"},l.a.createElement("div",{className:"Field Field--staticLabel Field--hasIcon"},l.a.createElement("label",{className:"Field-label",htmlFor:"contentTypeSelector"},Object(y.a)("newsletter.modal.select_label"),":"),l.a.createElement(g.a,{id:"contentTypeSelector",classes:["type--primary"],options:E,onChange:function(e){L(new u.a.List),v({type:e.target.value})},value:h.get("type")||"all"}),l.a.createElement("div",{className:"Field-iconContainer Field-iconContainer--navigatedown"},l.a.createElement(w.a,{isLegacy:!0,name:"navigatedown"})))))),l.a.createElement("div",{className:"u-zIndex--1 u-posRelative"},l.a.createElement(H,{content:d,isLoading:f,canPaginate:b,onLoadMore:p,exclude:o,selected:I,onSelect:function(e){L((function(t){var n=t.indexOf(e);return n>=0?t.delete(n):t.push(e)}))},hasSiteImageFallback:!0}))),l.a.createElement("div",{className:"Strip Strip--modal"},l.a.createElement("p",{className:"Strip-path u-textRight"},Object(y.a)("newsletter.modal.items_selected",{count:I.size})),l.a.createElement(V.a,{label:Object(y.a)("newsletter.modal.button_label"),disabled:0===I.size,onClick:function(){var e=I.map((function(e){return d.find((function(t){return t.get("id")===e}))}));n(e),r()},appearance:"brand"})))}K.propTypes={site:f.a.map,exclude:c.a.object.isRequired,excludePrivate:c.a.bool},K.defaultProps={excludePrivate:!1};t.a=Object(b.a)((function(){return{name:p.Ib,id:"default",title:Object(y.a)("newsletter.select_from_latest"),classes:["Modal--small"]}}))(K)}}]);